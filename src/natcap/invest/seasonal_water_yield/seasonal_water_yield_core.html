<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: seasonal_water_yield_core.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="seasonal_water_yield_core.cpp">seasonal_water_yield_core.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># cython: profile=False</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="c"># cython: language_level=2</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">003</span>: <span class="k">import</span> <span class="nn">logging</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_logging, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logging, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">004</span>: <span class="k">import</span> <span class="nn">os</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_os, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: <span class="k">import</span> <span class="nn">collections</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_collections, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_collections, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: <span class="k">import</span> <span class="nn">sys</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">007</span>: <span class="k">import</span> <span class="nn">gc</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_gc, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gc, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">008</span>: <span class="k">import</span> <span class="nn">pygeoprocessing</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pygeoprocessing, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pygeoprocessing, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">009</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: <span class="k">import</span> <span class="nn">numpy</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>: <span class="k">cimport</span> <span class="nn">numpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">gdal</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_gdal);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_gdal);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_gdal);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_osgeo, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gdal, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: <span class="k">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">ogr</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ogr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ogr);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_ogr);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_osgeo, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_ogr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ogr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span class="n">osr</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_osr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_osr);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_osr);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_osgeo, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_osr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_osr, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="k">from</span> <span class="nn">cython.operator</span> <span class="k">cimport</span> <span class="n">dereference</span> <span class="k">as</span> <span class="n">deref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: <span class="k">from</span> <span class="nn">cpython.mem</span> <span class="k">cimport</span> <span class="n">PyMem_Malloc</span><span class="p">,</span> <span class="n">PyMem_Free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: <span class="k">from</span> <span class="nn">cython.operator</span> <span class="k">cimport</span> <span class="n">dereference</span> <span class="k">as</span> <span class="n">deref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: <span class="k">from</span> <span class="nn">cython.operator</span> <span class="k">cimport</span> <span class="n">preincrement</span> <span class="k">as</span> <span class="n">inc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="k">from</span> <span class="nn">libcpp.list</span> <span class="k">cimport</span> <span class="nb">list</span> <span class="k">as</span> <span class="n">clist</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="k">from</span> <span class="nn">libcpp.set</span> <span class="k">cimport</span> <span class="nb">set</span> <span class="k">as</span> <span class="n">cset</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="k">from</span> <span class="nn">libcpp.pair</span> <span class="k">cimport</span> <span class="n">pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="k">from</span> <span class="nn">libcpp.stack</span> <span class="k">cimport</span> <span class="n">stack</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: <span class="k">from</span> <span class="nn">libcpp.queue</span> <span class="k">cimport</span> <span class="n">queue</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="k">from</span> <span class="nn">libc.time</span> <span class="k">cimport</span> <span class="n">time</span> <span class="k">as</span> <span class="n">ctime</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;time.h&quot;</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:     <span class="k">ctypedef</span> <span class="nb">int</span> <span class="n">time_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:     <span class="n">time_t</span> <span class="n">time</span><span class="p">(</span><span class="n">time_t</span><span class="o">*</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">is_close</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(double __pyx_v_x, double __pyx_v_y) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_close", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:     <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mf">1e-8</span><span class="o">+</span><span class="mf">1e-05</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (fabs((__pyx_v_x - __pyx_v_y)) &lt;= (1e-8 + (1e-05 * fabs(__pyx_v_y))));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;LRUCache.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>:     <span class="k">cdef</span> <span class="kt">cppclass</span> <span class="kt">LRUCache</span>[<span class="nf">KEY_T</span><span class="p">,</span> <span class="kt">VAL_T</span>]<span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>:         <span class="n">LRUCache</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>:         <span class="n">void</span> <span class="n">put</span><span class="p">(</span><span class="n">KEY_T</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">VAL_T</span><span class="o">&amp;</span><span class="p">,</span> <span class="n">clist</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="n">KEY_T</span><span class="p">,</span><span class="n">VAL_T</span><span class="p">]]</span><span class="o">&amp;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:         <span class="n">clist</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="n">KEY_T</span><span class="p">,</span><span class="n">VAL_T</span><span class="p">]]</span><span class="o">.</span><span class="n">iterator</span> <span class="n">begin</span><span class="p">()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>:         <span class="n">clist</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="n">KEY_T</span><span class="p">,</span><span class="n">VAL_T</span><span class="p">]]</span><span class="o">.</span><span class="n">iterator</span> <span class="n">end</span><span class="p">()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:         <span class="n">bint</span> <span class="n">exist</span><span class="p">(</span><span class="n">KEY_T</span> <span class="o">&amp;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:         <span class="n">VAL_T</span> <span class="n">get</span><span class="p">(</span><span class="n">KEY_T</span> <span class="o">&amp;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>: <span class="n">LOGGER</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_getLogger);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_LOGGER, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N_MONTHS</span> <span class="o">=</span> <span class="mf">12</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_N_MONTHS = 12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">PI</span> <span class="o">=</span> <span class="mf">3.141592653589793238462643383279502884</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_PI = 3.141592653589793238462643383279502884;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">INF</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inf</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_INF = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IMPROBABLE_FLOAT_NOATA</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.23789789e29</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_IMPROBABLE_FLOAT_NOATA = -1.23789789e29;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: <span class="c"># used to loop over neighbors and offset the x/y values as defined below</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: <span class="c">#  321</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: <span class="c">#  4x0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: <span class="c">#  567</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>: <span class="k">cdef</span> <span class="kt">int</span>* <span class="nf">NEIGHBOR_OFFSET_ARRAY</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5[0] = 1;
  __pyx_t_5[1] = 0;
  __pyx_t_5[2] = 1;
  __pyx_t_5[3] = -1;
  __pyx_t_5[4] = 0;
  __pyx_t_5[5] = -1;
  __pyx_t_5[6] = -1;
  __pyx_t_5[7] = -1;
  __pyx_t_5[8] = -1;
  __pyx_t_5[9] = 0;
  __pyx_t_5[10] = -1;
  __pyx_t_5[11] = 1;
  __pyx_t_5[12] = 0;
  __pyx_t_5[13] = 1;
  __pyx_t_5[14] = 1;
  __pyx_t_5[15] = 1;
  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>:     <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="c"># 0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:     <span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="c"># 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:     <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="c"># 2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:     <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="c"># 3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>:     <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span>  <span class="c"># 4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>:     <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span>  <span class="c"># 5</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:     <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span>  <span class="c"># 6</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:     <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span>  <span class="c"># 7</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:     <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: <span class="c"># index into this array with a direction and get the index for the reverse</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="c"># direction. Useful for determining the direction a neighbor flows into a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="c"># cell.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>: <span class="k">cdef</span> <span class="kt">int</span>* <span class="nf">FLOW_DIR_REVERSE_DIRECTION</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">7</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6[0] = 4;
  __pyx_t_6[1] = 5;
  __pyx_t_6[2] = 6;
  __pyx_t_6[3] = 7;
  __pyx_t_6[4] = 0;
  __pyx_t_6[5] = 1;
  __pyx_t_6[6] = 2;
  __pyx_t_6[7] = 3;
  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_FLOW_DIR_REVERSE_DIRECTION = __pyx_t_6;
</pre><pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="c"># this ctype is used to store the block ID and the block buffer as one object</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="c"># inside Managed Raster</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>: <span class="k">ctypedef</span> <span class="n">pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span><span class="p">]</span> <span class="n">BlockBufferPair</span></pre>
<pre class='cython code score-0 '>typedef std::pair&lt;int,double *&gt;  __pyx_t_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_BlockBufferPair;
</pre><pre class="cython line score-0">&#xA0;<span class="">075</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: <span class="c"># Number of raster blocks to hold in memory at once per Managed Raster</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">MANAGED_RASTER_N_BLOCKS</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="mf">4</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_MANAGED_RASTER_N_BLOCKS = 16;
</pre><pre class="cython line score-0">&#xA0;<span class="">078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="c"># a class to allow fast random per-pixel access to a raster for both setting</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="c"># and reading pixels.  Copied from src/pygeoprocessing/routing/routing.pyx,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="c"># revision 891288683889237cfd3a3d0a1f09483c23489fca.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">_ManagedRaster</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster {
  PyObject_HEAD
  struct __pyx_vtabstruct_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_vtab;
  LRUCache&lt;int,double *&gt;  *lru_cache;
  std::set&lt;int&gt;  dirty_blocks;
  int block_xsize;
  int block_ysize;
  int block_xmod;
  int block_ymod;
  int block_xbits;
  int block_ybits;
  long raster_x_size;
  long raster_y_size;
  int block_nx;
  int block_ny;
  int write_mode;
  PyObject *raster_path;
  int band_id;
  int closed;
};



struct __pyx_vtabstruct_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster {
  void (*set)(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *, long, long, double);
  double (*get)(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *, long, long);
  void (*_load_block)(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *, int);
};
static struct __pyx_vtabstruct_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_vtabptr_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster;
</pre><pre class="cython line score-0">&#xA0;<span class="">083</span>:     <span class="k">cdef</span> <span class="kt">LRUCache</span>[<span class="nf">int</span><span class="p">,</span> <span class="kt">double</span>*]* <span class="nf">lru_cache</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>:     <span class="k">cdef</span> <span class="kt">cset</span>[<span class="kt">int</span>] <span class="nf">dirty_blocks</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xsize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_ysize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xmod</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_ymod</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xbits</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_ybits</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">raster_x_size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">raster_y_size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">write_mode</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     <span class="k">cdef</span> <span class="kt">bytes</span> <span class="nf">raster_path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">band_id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">closed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raster_path</span><span class="p">,</span> <span class="n">band_id</span><span class="p">,</span> <span class="n">write_mode</span><span class="p">):</span></pre>
<pre class='cython code score-38 '>/* Python wrapper */
static int __pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_raster_path = 0;
  PyObject *__pyx_v_band_id = 0;
  PyObject *__pyx_v_write_mode = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_raster_path,&amp;__pyx_n_s_band_id,&amp;__pyx_n_s_write_mode,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_raster_path)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_band_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_write_mode)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_raster_path = values[0];
    __pyx_v_band_id = values[1];
    __pyx_v_write_mode = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster___cinit__(((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_v_self), __pyx_v_raster_path, __pyx_v_band_id, __pyx_v_write_mode);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster___cinit__(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self, PyObject *__pyx_v_raster_path, PyObject *__pyx_v_band_id, PyObject *__pyx_v_write_mode) {
  PyObject *__pyx_v_raster_info = NULL;
  PyObject *__pyx_v_err_msg = NULL;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raster_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_err_msg);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">101</span>:         <span class="sd">&quot;&quot;&quot;Create new instance of Managed Raster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">        Parameters:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">            raster_path (char*): path to raster that has block sizes that are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">                powers of 2. If not, an exception is raised.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">            band_id (int): which band in `raster_path` to index. Uses GDAL</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">                notation that starts at 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">            write_mode (boolean): if true, this raster is writable and dirty</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">                memory blocks will be written back to the raster as blocks</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">                are swapped out of the cache or when the object deconstructs.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: <span class="sd">            None.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:         <span class="n">raster_info</span> <span class="o">=</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">raster_path</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_raster_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_raster_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_raster_info = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span> <span class="o">=</span> <span class="n">raster_info</span><span class="p">[</span><span class="s">&#39;raster_size&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-62 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_raster_info, __pyx_n_s_raster_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 116, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_3); if (unlikely((__pyx_t_6 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self-&gt;raster_x_size = __pyx_t_6;
  __pyx_v_self-&gt;raster_y_size = __pyx_t_7;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span> <span class="o">=</span> <span class="n">raster_info</span><span class="p">[</span><span class="s">&#39;block_size&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-62 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_raster_info, __pyx_n_s_block_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self-&gt;block_xsize = __pyx_t_8;
  __pyx_v_self-&gt;block_ysize = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_xmod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;block_xmod = (__pyx_v_self-&gt;block_xsize - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_ymod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;block_ymod = (__pyx_v_self-&gt;block_ysize - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">120</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;=</span> <span class="n">band_id</span> <span class="o">&lt;=</span> <span class="n">raster_info</span><span class="p">[</span><span class="s">&#39;n_bands&#39;</span><span class="p">]):</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_1, __pyx_v_band_id, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_raster_info, __pyx_n_s_n_bands);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_band_id, __pyx_t_3, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = ((!__pyx_t_10) != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">122</span>:             <span class="n">err_msg</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>:                 <span class="s">&quot;Error: band ID (</span><span class="si">%s</span><span class="s">) is not a valid band number. &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:                 <span class="s">&quot;This exception is happening in Cython, so it will cause a &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:                 <span class="s">&quot;hard seg-fault, but it&#39;s otherwise meant to be a &quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:                 <span class="s">&quot;ValueError.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">band_id</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_Error_band_ID_s_is_not_a_valid_b, __pyx_v_band_id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_err_msg = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:             <span class="k">print</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_v_err_msg) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_err_msg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">band_id</span> <span class="o">=</span> <span class="n">band_id</span></pre>
<pre class='cython code score-7 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_band_id); if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  __pyx_v_self-&gt;band_id = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:         <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = (((__pyx_v_self-&gt;block_xsize &amp; (__pyx_v_self-&gt;block_xsize - 1)) != 0) != 0);
  if (!__pyx_t_10) {
  } else {
    __pyx_t_11 = __pyx_t_10;
    goto __pyx_L9_bool_binop_done;
  }
/* … */
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = (((__pyx_v_self-&gt;block_ysize &amp; (__pyx_v_self-&gt;block_ysize - 1)) != 0) != 0);
  __pyx_t_11 = __pyx_t_10;
  __pyx_L9_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">133</span>:             <span class="c"># If inputs are not a power of two, this will at least print</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>:             <span class="c"># an error message. Unfortunately with Cython, the exception will</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>:             <span class="c"># present itself as a hard seg-fault, but I&#39;m leaving the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>:             <span class="c"># ValueError in here at least for readability.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>:             <span class="n">err_msg</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:                 <span class="s">&quot;Error: Block size is not a power of two: &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:                 <span class="s">&quot;block_xsize: </span><span class="si">%d</span><span class="s">, </span><span class="si">%d</span><span class="s">, </span><span class="si">%s</span><span class="s">. This exception is happening&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>:                 <span class="s">&quot;in Cython, so it will cause a hard seg-fault, but it&#39;s&quot;</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:                 <span class="s">&quot;otherwise meant to be a ValueError.&quot;</span> <span class="o">%</span> <span class="p">(</span></pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Error_Block_size_is_not_a_power, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_err_msg = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="p">,</span> <span class="n">raster_path</span><span class="p">))</span></pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_raster_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_raster_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_raster_path);
    __pyx_t_1 = 0;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:             <span class="k">print</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_v_err_msg) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_err_msg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_log2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self-&gt;block_xbits = __pyx_t_9;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_log2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self-&gt;block_ybits = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;block_nx = __Pyx_div_long(__pyx_t_7, __pyx_v_self-&gt;block_xsize);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span></pre>
<pre class='cython code score-10 '>  __pyx_t_7 = ((__pyx_v_self-&gt;raster_x_size + __pyx_v_self-&gt;block_xsize) - 1);
  if (unlikely(__pyx_v_self-&gt;block_xsize == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
  }
  else if (sizeof(long) == sizeof(long) &amp;&amp; (!(((int)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_self-&gt;block_xsize == (int)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_7))) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">block_ny</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;block_ny = __Pyx_div_long(__pyx_t_7, __pyx_v_self-&gt;block_ysize);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span></pre>
<pre class='cython code score-10 '>  __pyx_t_7 = ((__pyx_v_self-&gt;raster_y_size + __pyx_v_self-&gt;block_ysize) - 1);
  if (unlikely(__pyx_v_self-&gt;block_ysize == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  }
  else if (sizeof(long) == sizeof(long) &amp;&amp; (!(((int)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_self-&gt;block_ysize == (int)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_7))) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span> <span class="o">=</span> <span class="n">new</span> <span class="n">LRUCache</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span><span class="p">](</span><span class="n">MANAGED_RASTER_N_BLOCKS</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;lru_cache = new LRUCache&lt;int,double *&gt; (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_MANAGED_RASTER_N_BLOCKS);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">raster_path</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">bytes</span><span class="p">&gt;</span> <span class="n">raster_path</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = __pyx_v_raster_path;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;raster_path);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;raster_path);
  __pyx_v_self-&gt;raster_path = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span> <span class="o">=</span> <span class="n">write_mode</span></pre>
<pre class='cython code score-7 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_write_mode); if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>
  __pyx_v_self-&gt;write_mode = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;closed = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static void __pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_2__dealloc__(((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_2__dealloc__(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">159</span>:         <span class="sd">&quot;&quot;&quot;Deallocate _ManagedRaster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: <span class="sd">        This operation manually frees memory from the LRUCache and writes any</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: <span class="sd">        dirty memory blocks back to the raster if `self.write_mode` is True.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_close);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>/* Python wrapper */
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_5close(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_4close[] = "Close the _ManagedRaster and free up resources.\n\n            This call writes any dirty blocks to disk, frees up the memory\n            allocated as part of the cache, and frees all GDAL references.\n\n            Any subsequent calls to any other functions in _ManagedRaster will\n            have undefined behavior.\n        ";
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_5close(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("close (wrapper)", 0);
  __pyx_r = __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_4close(((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_4close(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self) {
  int __pyx_v_xi_copy;
  int __pyx_v_yi_copy;
  PyArrayObject *__pyx_v_block_array = 0;
  double *__pyx_v_double_buffer;
  int __pyx_v_block_xi;
  int __pyx_v_block_yi;
  int __pyx_v_win_xsize;
  int __pyx_v_win_ysize;
  int __pyx_v_xoff;
  int __pyx_v_yoff;
  std::list&lt;__pyx_t_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_BlockBufferPair&gt; ::iterator __pyx_v_it;
  std::list&lt;__pyx_t_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_BlockBufferPair&gt; ::iterator __pyx_v_end;
  PyObject *__pyx_v_raster = NULL;
  PyObject *__pyx_v_raster_band = NULL;
  std::set&lt;int&gt; ::iterator __pyx_v_dirty_itr;
  PyObject *__pyx_v_block_index = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_block_array;
  __Pyx_Buffer __pyx_pybuffer_block_array;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("close", 0);
  __pyx_pybuffer_block_array.pybuffer.buf = NULL;
  __pyx_pybuffer_block_array.refcount = 0;
  __pyx_pybuffernd_block_array.data = NULL;
  __pyx_pybuffernd_block_array.rcbuffer = &amp;__pyx_pybuffer_block_array;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.close", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_block_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raster_band);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_block_index);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>:         <span class="sd">&quot;&quot;&quot;Close the _ManagedRaster and free up resources.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>: <span class="sd">            This call writes any dirty blocks to disk, frees up the memory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>: <span class="sd">            allocated as part of the cache, and frees all GDAL references.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: <span class="sd">            Any subsequent calls to any other functions in _ManagedRaster will</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: <span class="sd">            have undefined behavior.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;closed != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:             <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;closed = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">178</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xi_copy</span><span class="p">,</span> <span class="nf">yi_copy</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">double</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">block_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_block_array = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_block_array.diminfo[0].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_block_array.diminfo[0].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_block_array.diminfo[1].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_block_array.diminfo[1].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_block_array = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">))</span></pre>
<pre class='cython code score-26 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">181</span>:         <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">double_buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xi</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_yi</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:         <span class="c"># initially the win size is the same as the block size unless</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>:         <span class="c"># we&#39;re at the edge of a raster</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">win_xsize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">win_ysize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>:         <span class="c"># we need the offsets to subtract from global indexes for cached array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xoff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">yoff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:         <span class="k">cdef</span> <span class="kt">clist</span>[<span class="kt">BlockBufferPair</span>].<span class="kt">iterator</span> <span class="nf">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_it = __pyx_v_self-&gt;lru_cache-&gt;begin();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:         <span class="k">cdef</span> <span class="kt">clist</span>[<span class="kt">BlockBufferPair</span>].<span class="kt">iterator</span> <span class="nf">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">end</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_end = __pyx_v_self-&gt;lru_cache-&gt;end();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_self-&gt;write_mode != 0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:             <span class="k">while</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">end</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_1 = ((__pyx_v_it != __pyx_v_end) != 0);
      if (!__pyx_t_1) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>:                 <span class="c"># write the changed value back if desired</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:                 <span class="n">PyMem_Free</span><span class="p">(</span><span class="n">deref</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">second</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>((*__pyx_v_it).second);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:                 <span class="n">inc</span><span class="p">(</span><span class="n">it</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      (void)((++__pyx_v_it));
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:             <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">201</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:         <span class="n">raster</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OpenEx</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_OpenEx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">raster_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GA_Update</span> <span class="o">|</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OF_RASTER</span><span class="p">)</span></pre>
<pre class='cython code score-55 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_GA_Update);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_OF_RASTER);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Or</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_self-&gt;raster_path, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_self-&gt;raster_path, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;raster_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;raster_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_v_self-&gt;raster_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_raster = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:         <span class="n">raster_band</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_id</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster, __pyx_n_s_GetRasterBand);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;band_id);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_raster_band = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">206</span>:         <span class="c"># if we get here, we&#39;re in write_mode</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">207</span>:         <span class="k">cdef</span> <span class="kt">cset</span>[<span class="kt">int</span>].<span class="kt">iterator</span> <span class="nf">dirty_itr</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="k">while</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">end</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__pyx_v_it != __pyx_v_end) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:             <span class="n">double_buffer</span> <span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">second</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = (*__pyx_v_it).second;
    __pyx_v_double_buffer = __pyx_t_9;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:             <span class="n">block_index</span> <span class="o">=</span> <span class="n">deref</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">first</span></pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*__pyx_v_it).first);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_block_index, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>:             <span class="c"># write to disk if block is dirty</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:             <span class="n">dirty_itr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_block_index); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
    __pyx_v_dirty_itr = __pyx_v_self-&gt;dirty_blocks.find(__pyx_t_8);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:             <span class="k">if</span> <span class="n">dirty_itr</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">end</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_dirty_itr != __pyx_v_self-&gt;dirty_blocks.end()) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">erase</span><span class="p">(</span><span class="n">dirty_itr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      (void)(__pyx_v_self-&gt;dirty_blocks.erase(__pyx_v_dirty_itr));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:                 <span class="n">block_xi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-16 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_nx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_block_index, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_6); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_block_xi = __pyx_t_8;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:                 <span class="n">block_yi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-13 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_nx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_block_index, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_block_yi = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:                 <span class="c"># we need the offsets to subtract from global indexes for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>:                 <span class="c"># cached array</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:                 <span class="n">xoff</span> <span class="o">=</span> <span class="n">block_xi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span></pre>
<pre class='cython code score-0 '>      __pyx_v_xoff = (__pyx_v_block_xi &lt;&lt; __pyx_v_self-&gt;block_xbits);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                 <span class="n">yoff</span> <span class="o">=</span> <span class="n">block_yi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span></pre>
<pre class='cython code score-0 '>      __pyx_v_yoff = (__pyx_v_block_yi &lt;&lt; __pyx_v_self-&gt;block_ybits);
</pre><pre class="cython line score-0">&#xA0;<span class="">223</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:                 <span class="n">win_xsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_self-&gt;block_xsize;
      __pyx_v_win_xsize = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                 <span class="n">win_ysize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_self-&gt;block_ysize;
      __pyx_v_win_ysize = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>:                 <span class="c"># clip window sizes if necessary</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:                 <span class="k">if</span> <span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = (((__pyx_v_xoff + __pyx_v_win_xsize) &gt; __pyx_v_self-&gt;raster_x_size) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:                     <span class="n">win_xsize</span> <span class="o">=</span> <span class="n">win_xsize</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>        __pyx_v_win_xsize = (__pyx_v_win_xsize - ((__pyx_v_xoff + __pyx_v_win_xsize) - __pyx_v_self-&gt;raster_x_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">230</span>:                         <span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:                 <span class="k">if</span> <span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = (((__pyx_v_yoff + __pyx_v_win_ysize) &gt; __pyx_v_self-&gt;raster_y_size) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:                     <span class="n">win_ysize</span> <span class="o">=</span> <span class="n">win_ysize</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>        __pyx_v_win_ysize = (__pyx_v_win_ysize - ((__pyx_v_yoff + __pyx_v_win_ysize) - __pyx_v_self-&gt;raster_y_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>:                         <span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:                 <span class="k">for</span> <span class="n">xi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_xsize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = __pyx_v_win_xsize;
      __pyx_t_10 = __pyx_t_8;
      for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
        __pyx_v_xi_copy = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                     <span class="k">for</span> <span class="n">yi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_ysize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_win_ysize;
        __pyx_t_13 = __pyx_t_12;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_yi_copy = __pyx_t_14;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:                         <span class="n">block_array</span><span class="p">[</span><span class="n">yi_copy</span><span class="p">,</span> <span class="n">xi_copy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-2 '>          __pyx_t_15 = __pyx_v_yi_copy;
          __pyx_t_16 = __pyx_v_xi_copy;
          __pyx_t_17 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_pybuffernd_block_array.diminfo[0].shape;
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_17 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_block_array.diminfo[0].shape)) __pyx_t_17 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_pybuffernd_block_array.diminfo[1].shape;
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_17 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_block_array.diminfo[1].shape)) __pyx_t_17 = 1;
          if (unlikely(__pyx_t_17 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
            <span class='error_goto'>__PYX_ERR(0, 237, __pyx_L1_error)</span>
          }
          *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_block_array.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_block_array.diminfo[1].strides) = (__pyx_v_double_buffer[((__pyx_v_yi_copy &lt;&lt; __pyx_v_self-&gt;block_xbits) + __pyx_v_xi_copy)]);
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">238</span>:                             <span class="n">double_buffer</span><span class="p">[</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">239</span>:                                 <span class="p">(</span><span class="n">yi_copy</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span> <span class="o">+</span> <span class="n">xi_copy</span><span class="p">])</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:                 <span class="n">raster_band</span><span class="o">.</span><span class="n">WriteArray</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster_band, __pyx_n_s_WriteArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
      __pyx_t_4 = 0;
/* … */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:                     <span class="n">block_array</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">win_ysize</span><span class="p">,</span> <span class="mf">0</span><span class="p">:</span><span class="n">win_xsize</span><span class="p">],</span></pre>
<pre class='cython code score-26 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
      __pyx_t_5 = 0;
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_block_array), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:                     <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">)</span></pre>
<pre class='cython code score-18 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_xoff);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_xoff, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_yoff);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_yoff, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:             <span class="n">PyMem_Free</span><span class="p">(</span><span class="n">double_buffer</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_double_buffer);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:             <span class="n">inc</span><span class="p">(</span><span class="n">it</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    (void)((++__pyx_v_it));
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:         <span class="n">raster_band</span><span class="o">.</span><span class="n">FlushCache</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster_band, __pyx_n_s_FlushCache);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         <span class="n">raster_band</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster_band, Py_None);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         <span class="n">raster</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster, Py_None);
</pre><pre class="cython line score-0">&#xA0;<span class="">248</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">xi</span><span class="p">,</span> <span class="nb">long</span> <span class="n">yi</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE void __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self, long __pyx_v_xi, long __pyx_v_yi, double __pyx_v_value) {
  int __pyx_v_block_xi;
  int __pyx_v_block_yi;
  int __pyx_v_block_index;
  std::set&lt;int&gt; ::iterator __pyx_v_dirty_itr;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.set", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">250</span>:         <span class="sd">&quot;&quot;&quot;Set the pixel at `xi,yi` to `value`.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xi</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_xi = (__pyx_v_xi &gt;&gt; __pyx_v_self-&gt;block_xbits);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_yi</span> <span class="o">=</span> <span class="n">yi</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_yi = (__pyx_v_yi &gt;&gt; __pyx_v_self-&gt;block_ybits);
</pre><pre class="cython line score-0">&#xA0;<span class="">253</span>:         <span class="c"># this is the flat index for the block</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_index</span> <span class="o">=</span> <span class="n">block_yi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span> <span class="o">+</span> <span class="n">block_xi</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_index = ((__pyx_v_block_yi * __pyx_v_self-&gt;block_nx) + __pyx_v_block_xi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">exist</span><span class="p">(</span><span class="n">block_index</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_self-&gt;lru_cache-&gt;exist(__pyx_v_block_index) != 0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_load_block</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_load_block(__pyx_v_self, __pyx_v_block_index);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 256, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">257</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>:             <span class="n">block_index</span><span class="p">)[</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:                 <span class="p">((</span><span class="n">yi</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ymod</span><span class="p">))</span><span class="o">&lt;&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;lru_cache-&gt;get(__pyx_v_block_index)[(((__pyx_v_yi &amp; __pyx_v_self-&gt;block_ymod) &lt;&lt; __pyx_v_self-&gt;block_xbits) + (__pyx_v_xi &amp; __pyx_v_self-&gt;block_xmod))]) = __pyx_v_value;
</pre><pre class="cython line score-0">&#xA0;<span class="">260</span>:                 <span class="p">(</span><span class="n">xi</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xmod</span><span class="p">))]</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;write_mode != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:             <span class="n">dirty_itr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dirty_itr = __pyx_v_self-&gt;dirty_blocks.find(__pyx_v_block_index);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:             <span class="k">if</span> <span class="n">dirty_itr</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">end</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_dirty_itr == __pyx_v_self-&gt;dirty_blocks.end()) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      try {
        __pyx_v_self-&gt;dirty_blocks.insert(__pyx_v_block_index);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 264, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">xi</span><span class="p">,</span> <span class="nb">long</span> <span class="n">yi</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE double __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self, long __pyx_v_xi, long __pyx_v_yi) {
  int __pyx_v_block_xi;
  int __pyx_v_block_yi;
  int __pyx_v_block_index;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster.get", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>:         <span class="sd">&quot;&quot;&quot;Return the value of the pixel at `xi,yi`.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xi</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_xi = (__pyx_v_xi &gt;&gt; __pyx_v_self-&gt;block_xbits);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_yi</span> <span class="o">=</span> <span class="n">yi</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_yi = (__pyx_v_yi &gt;&gt; __pyx_v_self-&gt;block_ybits);
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>:         <span class="c"># this is the flat index for the block</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_index</span> <span class="o">=</span> <span class="n">block_yi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span> <span class="o">+</span> <span class="n">block_xi</span></pre>
<pre class='cython code score-0 '>  __pyx_v_block_index = ((__pyx_v_block_yi * __pyx_v_self-&gt;block_nx) + __pyx_v_block_xi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">exist</span><span class="p">(</span><span class="n">block_index</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_self-&gt;lru_cache-&gt;exist(__pyx_v_block_index) != 0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_load_block</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_load_block(__pyx_v_self, __pyx_v_block_index);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 273, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">274</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:             <span class="n">block_index</span><span class="p">)[</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;lru_cache-&gt;get(__pyx_v_block_index)[(((__pyx_v_yi &amp; __pyx_v_self-&gt;block_ymod) &lt;&lt; __pyx_v_self-&gt;block_xbits) + (__pyx_v_xi &amp; __pyx_v_self-&gt;block_xmod))]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">276</span>:                 <span class="p">((</span><span class="n">yi</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ymod</span><span class="p">))</span><span class="o">&lt;&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span> <span class="o">+</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">277</span>:                 <span class="p">(</span><span class="n">xi</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xmod</span><span class="p">))]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">278</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_load_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">block_index</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython code score-18 '>static void __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster__load_block(struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_self, int __pyx_v_block_index) {
  int __pyx_v_block_xi;
  int __pyx_v_block_yi;
  int __pyx_v_xoff;
  int __pyx_v_yoff;
  int __pyx_v_xi_copy;
  int __pyx_v_yi_copy;
  PyArrayObject *__pyx_v_block_array = 0;
  double *__pyx_v_double_buffer;
  std::list&lt;__pyx_t_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_BlockBufferPair&gt;  __pyx_v_removed_value_list;
  int __pyx_v_win_xsize;
  int __pyx_v_win_ysize;
  PyObject *__pyx_v_raster = NULL;
  PyObject *__pyx_v_raster_band = NULL;
  std::set&lt;int&gt; ::iterator __pyx_v_dirty_itr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_block_array;
  __Pyx_Buffer __pyx_pybuffer_block_array;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_load_block", 0);
  __pyx_pybuffer_block_array.pybuffer.buf = NULL;
  __pyx_pybuffer_block_array.refcount = 0;
  __pyx_pybuffernd_block_array.data = NULL;
  __pyx_pybuffernd_block_array.rcbuffer = &amp;__pyx_pybuffer_block_array;
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core._ManagedRaster._load_block", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_block_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raster_band);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_xi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;block_nx == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
  }
  __pyx_v_block_xi = __Pyx_mod_int(__pyx_v_block_index, __pyx_v_self-&gt;block_nx);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">block_yi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-10 '>  if (unlikely(__pyx_v_self-&gt;block_nx == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
  }
  else if (sizeof(int) == sizeof(long) &amp;&amp; (!(((int)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_self-&gt;block_nx == (int)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_block_index))) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
  }
  __pyx_v_block_yi = __Pyx_div_int(__pyx_v_block_index, __pyx_v_self-&gt;block_nx);
</pre><pre class="cython line score-0">&#xA0;<span class="">282</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">283</span>:         <span class="c"># we need the offsets to subtract from global indexes for cached array</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xoff</span> <span class="o">=</span> <span class="n">block_xi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_xoff = (__pyx_v_block_xi &lt;&lt; __pyx_v_self-&gt;block_xbits);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">yoff</span> <span class="o">=</span> <span class="n">block_yi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span></pre>
<pre class='cython code score-0 '>  __pyx_v_yoff = (__pyx_v_block_yi &lt;&lt; __pyx_v_self-&gt;block_ybits);
</pre><pre class="cython line score-0">&#xA0;<span class="">286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xi_copy</span><span class="p">,</span> <span class="nf">yi_copy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>:         <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">double</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">block_array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">289</span>:         <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">double_buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">290</span>:         <span class="k">cdef</span> <span class="kt">clist</span>[<span class="kt">BlockBufferPair</span>] <span class="nf">removed_value_list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:         <span class="c"># determine the block aligned xoffset for read as array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>:         <span class="c"># initially the win size is the same as the block size unless</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">295</span>:         <span class="c"># we&#39;re at the edge of a raster</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">win_xsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;block_xsize;
  __pyx_v_win_xsize = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">win_ysize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;block_ysize;
  __pyx_v_win_ysize = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>:         <span class="c"># load a new block</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:         <span class="k">if</span> <span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_xoff + __pyx_v_win_xsize) &gt; __pyx_v_self-&gt;raster_x_size) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:             <span class="n">win_xsize</span> <span class="o">=</span> <span class="n">win_xsize</span> <span class="o">-</span> <span class="p">(</span><span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_win_xsize = (__pyx_v_win_xsize - ((__pyx_v_xoff + __pyx_v_win_xsize) - __pyx_v_self-&gt;raster_x_size));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">302</span>:         <span class="k">if</span> <span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_yoff + __pyx_v_win_ysize) &gt; __pyx_v_self-&gt;raster_y_size) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:             <span class="n">win_ysize</span> <span class="o">=</span> <span class="n">win_ysize</span> <span class="o">-</span> <span class="p">(</span><span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_win_ysize = (__pyx_v_win_ysize - ((__pyx_v_yoff + __pyx_v_win_ysize) - __pyx_v_self-&gt;raster_y_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">304</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:         <span class="n">raster</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OpenEx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raster_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OF_RASTER</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_OpenEx);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_OF_RASTER);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_1 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_1 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_self-&gt;raster_path, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_1, 2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_self-&gt;raster_path, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_1, 2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;raster_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;raster_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_1, __pyx_v_self-&gt;raster_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_raster = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:         <span class="n">raster_band</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_id</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster, __pyx_n_s_GetRasterBand);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;band_id);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 306, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_raster_band = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:         <span class="n">block_array</span> <span class="o">=</span> <span class="n">raster_band</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster_band, __pyx_n_s_ReadAsArray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:             <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">,</span> <span class="n">win_xsize</span><span class="o">=</span><span class="n">win_xsize</span><span class="p">,</span></pre>
<pre class='cython code score-26 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_xoff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_xoff, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_yoff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_yoff, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_win_xsize, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:             <span class="n">win_ysize</span><span class="o">=</span><span class="n">win_ysize</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span></pre>
<pre class='cython code score-31 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_win_ysize, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_1 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_block_array, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_block_array.diminfo[0].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_block_array.diminfo[0].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_block_array.diminfo[1].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_block_array.diminfo[1].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  __pyx_v_block_array = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:             <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:         <span class="n">raster_band</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster_band, Py_None);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:         <span class="n">raster</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster, Py_None);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:         <span class="n">double_buffer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">double</span><span class="o">*&gt;</span><span class="n">PyMem_Malloc</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  __pyx_v_double_buffer = ((double *)<span class='py_c_api'>PyMem_Malloc</span>((((sizeof(double)) &lt;&lt; __pyx_v_self-&gt;block_xbits) * __pyx_v_win_ysize)));
</pre><pre class="cython line score-0">&#xA0;<span class="">314</span>:             <span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span> <span class="o">*</span> <span class="n">win_ysize</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:         <span class="k">for</span> <span class="n">xi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_xsize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_win_xsize;
  __pyx_t_12 = __pyx_t_1;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_xi_copy = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:             <span class="k">for</span> <span class="n">yi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_ysize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_win_ysize;
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_yi_copy = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:                 <span class="n">double_buffer</span><span class="p">[(</span><span class="n">yi_copy</span><span class="o">&lt;&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span><span class="o">+</span><span class="n">xi_copy</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_double_buffer[((__pyx_v_yi_copy &lt;&lt; __pyx_v_self-&gt;block_xbits) + __pyx_v_xi_copy)]) = (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_block_array.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_block_array.diminfo[1].strides));
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:                     <span class="n">block_array</span><span class="p">[</span><span class="n">yi_copy</span><span class="p">,</span> <span class="n">xi_copy</span><span class="p">])</span></pre>
<pre class='cython code score-2 '>      __pyx_t_17 = __pyx_v_yi_copy;
      __pyx_t_18 = __pyx_v_xi_copy;
      __pyx_t_19 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_pybuffernd_block_array.diminfo[0].shape;
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_block_array.diminfo[0].shape)) __pyx_t_19 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_pybuffernd_block_array.diminfo[1].shape;
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_block_array.diminfo[1].shape)) __pyx_t_19 = 1;
      if (unlikely(__pyx_t_19 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
        <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lru_cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;lru_cache-&gt;put(((int)__pyx_v_block_index), ((double *)__pyx_v_double_buffer), __pyx_v_removed_value_list);
</pre><pre class="cython line score-0">&#xA0;<span class="">320</span>:             <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">block_index</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">double</span><span class="o">*&gt;</span><span class="n">double_buffer</span><span class="p">,</span> <span class="n">removed_value_list</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;write_mode != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:             <span class="n">raster</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OpenEx</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_OpenEx);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">raster_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GA_Update</span> <span class="o">|</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OF_RASTER</span><span class="p">)</span></pre>
<pre class='cython code score-56 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_GA_Update);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_OF_RASTER);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Or</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_1 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_1 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_self-&gt;raster_path, __pyx_t_7};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_1, 2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_self-&gt;raster_path, __pyx_t_7};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_1, 2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;raster_path);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;raster_path);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_1, __pyx_v_self-&gt;raster_path);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_1, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:             <span class="n">raster_band</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_id</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster, __pyx_n_s_GetRasterBand);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;band_id);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster_band, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">326</span>: </pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:         <span class="n">block_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7);
  __pyx_t_7 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_1 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_block_array, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_block_array.diminfo[0].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_block_array.diminfo[0].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_block_array.diminfo[1].strides = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_block_array.diminfo[1].shape = __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_block_array, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;block_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:         <span class="k">while</span> <span class="ow">not</span> <span class="n">removed_value_list</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_2 = ((!(__pyx_v_removed_value_list.empty() != 0)) != 0);
    if (!__pyx_t_2) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">330</span>:             <span class="c"># write the changed value back if desired</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:             <span class="n">double_buffer</span> <span class="o">=</span> <span class="n">removed_value_list</span><span class="o">.</span><span class="n">front</span><span class="p">()</span><span class="o">.</span><span class="n">second</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_removed_value_list.front().second;
    __pyx_v_double_buffer = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">332</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_self-&gt;write_mode != 0);
    if (__pyx_t_2) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:                 <span class="n">block_index</span> <span class="o">=</span> <span class="n">removed_value_list</span><span class="o">.</span><span class="n">front</span><span class="p">()</span><span class="o">.</span><span class="n">first</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = __pyx_v_removed_value_list.front().first;
      __pyx_v_block_index = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>:                 <span class="c"># write back the block if it&#39;s dirty</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:                 <span class="n">dirty_itr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">block_index</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_dirty_itr = __pyx_v_self-&gt;dirty_blocks.find(__pyx_v_block_index);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:                 <span class="k">if</span> <span class="n">dirty_itr</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">end</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_dirty_itr != __pyx_v_self-&gt;dirty_blocks.end()) != 0);
      if (__pyx_t_2) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">dirty_blocks</span><span class="o">.</span><span class="n">erase</span><span class="p">(</span><span class="n">dirty_itr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        (void)(__pyx_v_self-&gt;dirty_blocks.erase(__pyx_v_dirty_itr));
</pre><pre class="cython line score-0">&#xA0;<span class="">340</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:                     <span class="n">block_xi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-5 '>        if (unlikely(__pyx_v_self-&gt;block_nx == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
          <span class='error_goto'>__PYX_ERR(0, 341, __pyx_L1_error)</span>
        }
        __pyx_v_block_xi = __Pyx_mod_int(__pyx_v_block_index, __pyx_v_self-&gt;block_nx);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:                     <span class="n">block_yi</span> <span class="o">=</span> <span class="n">block_index</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_nx</span></pre>
<pre class='cython code score-10 '>        if (unlikely(__pyx_v_self-&gt;block_nx == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
          <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
        }
        else if (sizeof(int) == sizeof(long) &amp;&amp; (!(((int)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_self-&gt;block_nx == (int)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_block_index))) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
          <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
        }
        __pyx_v_block_yi = __Pyx_div_int(__pyx_v_block_index, __pyx_v_self-&gt;block_nx);
</pre><pre class="cython line score-0">&#xA0;<span class="">343</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:                     <span class="n">xoff</span> <span class="o">=</span> <span class="n">block_xi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span></pre>
<pre class='cython code score-0 '>        __pyx_v_xoff = (__pyx_v_block_xi &lt;&lt; __pyx_v_self-&gt;block_xbits);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:                     <span class="n">yoff</span> <span class="o">=</span> <span class="n">block_yi</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ybits</span></pre>
<pre class='cython code score-0 '>        __pyx_v_yoff = (__pyx_v_block_yi &lt;&lt; __pyx_v_self-&gt;block_ybits);
</pre><pre class="cython line score-0">&#xA0;<span class="">346</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>:                     <span class="n">win_xsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xsize</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = __pyx_v_self-&gt;block_xsize;
        __pyx_v_win_xsize = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:                     <span class="n">win_ysize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_ysize</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = __pyx_v_self-&gt;block_ysize;
        __pyx_v_win_ysize = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">349</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:                     <span class="k">if</span> <span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_2 = (((__pyx_v_xoff + __pyx_v_win_xsize) &gt; __pyx_v_self-&gt;raster_x_size) != 0);
        if (__pyx_t_2) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:                         <span class="n">win_xsize</span> <span class="o">=</span> <span class="n">win_xsize</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_v_win_xsize = (__pyx_v_win_xsize - ((__pyx_v_xoff + __pyx_v_win_xsize) - __pyx_v_self-&gt;raster_x_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">352</span>:                             <span class="n">xoff</span><span class="o">+</span><span class="n">win_xsize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_x_size</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:                     <span class="k">if</span> <span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_2 = (((__pyx_v_yoff + __pyx_v_win_ysize) &gt; __pyx_v_self-&gt;raster_y_size) != 0);
        if (__pyx_t_2) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:                         <span class="n">win_ysize</span> <span class="o">=</span> <span class="n">win_ysize</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_v_win_ysize = (__pyx_v_win_ysize - ((__pyx_v_yoff + __pyx_v_win_ysize) - __pyx_v_self-&gt;raster_y_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">355</span>:                             <span class="n">yoff</span><span class="o">+</span><span class="n">win_ysize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">raster_y_size</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:                     <span class="k">for</span> <span class="n">xi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_xsize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = __pyx_v_win_xsize;
        __pyx_t_12 = __pyx_t_1;
        for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_xi_copy = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:                         <span class="k">for</span> <span class="n">yi_copy</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_ysize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_win_ysize;
          __pyx_t_15 = __pyx_t_14;
          for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
            __pyx_v_yi_copy = __pyx_t_16;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:                             <span class="n">block_array</span><span class="p">[</span><span class="n">yi_copy</span><span class="p">,</span> <span class="n">xi_copy</span><span class="p">]</span> <span class="o">=</span> <span class="n">double_buffer</span><span class="p">[</span></pre>
<pre class='cython code score-2 '>            __pyx_t_18 = __pyx_v_yi_copy;
            __pyx_t_17 = __pyx_v_xi_copy;
            __pyx_t_19 = -1;
            if (__pyx_t_18 &lt; 0) {
              __pyx_t_18 += __pyx_pybuffernd_block_array.diminfo[0].shape;
              if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 0;
            } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_block_array.diminfo[0].shape)) __pyx_t_19 = 0;
            if (__pyx_t_17 &lt; 0) {
              __pyx_t_17 += __pyx_pybuffernd_block_array.diminfo[1].shape;
              if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 1;
            } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_block_array.diminfo[1].shape)) __pyx_t_19 = 1;
            if (unlikely(__pyx_t_19 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
              <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
            }
            *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_block_array.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_block_array.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_block_array.diminfo[1].strides) = (__pyx_v_double_buffer[((__pyx_v_yi_copy &lt;&lt; __pyx_v_self-&gt;block_xbits) + __pyx_v_xi_copy)]);
          }
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>:                                 <span class="p">(</span><span class="n">yi_copy</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_xbits</span><span class="p">)</span> <span class="o">+</span> <span class="n">xi_copy</span><span class="p">]</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:                     <span class="n">raster_band</span><span class="o">.</span><span class="n">WriteArray</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_raster_band, __pyx_n_s_WriteArray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5);
        __pyx_t_5 = 0;
/* … */
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:                         <span class="n">block_array</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">win_ysize</span><span class="p">,</span> <span class="mf">0</span><span class="p">:</span><span class="n">win_xsize</span><span class="p">],</span></pre>
<pre class='cython code score-26 '>        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_6 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_7, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_win_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_7, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_5);
        __pyx_t_6 = 0;
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_block_array), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:                         <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">)</span></pre>
<pre class='cython code score-18 '>        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_xoff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_xoff, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_yoff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_yoff, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:             <span class="n">PyMem_Free</span><span class="p">(</span><span class="n">double_buffer</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_double_buffer);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:             <span class="n">removed_value_list</span><span class="o">.</span><span class="n">pop_front</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_v_removed_value_list.pop_front();
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">366</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_mode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;write_mode != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:             <span class="n">raster_band</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster_band, Py_None);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:             <span class="n">raster</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_raster, Py_None);
</pre><pre class="cython line score-0">&#xA0;<span class="">370</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-162" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>: <span class="k">cpdef</span> <span class="nf">calculate_local_recharge</span><span class="p">(</span></pre>
<pre class='cython code score-162 '>static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_1calculate_local_recharge(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_calculate_local_recharge(PyObject *__pyx_v_precip_path_list, PyObject *__pyx_v_et0_path_list, PyObject *__pyx_v_qf_m_path_list, PyObject *__pyx_v_flow_dir_mfd_path, PyObject *__pyx_v_kc_path_list, PyObject *__pyx_v_alpha_month_map, float __pyx_v_beta_i, float __pyx_v_gamma, CYTHON_UNUSED PyObject *__pyx_v_stream_path, PyObject *__pyx_v_target_li_path, PyObject *__pyx_v_target_li_avail_path, PyObject *__pyx_v_target_l_sum_avail_path, PyObject *__pyx_v_target_aet_path, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_i_n;
  int __pyx_v_flow_dir_mfd;
  int __pyx_v_peak_pixel;
  int __pyx_v_xs;
  int __pyx_v_ys;
  int __pyx_v_xs_root;
  int __pyx_v_ys_root;
  int __pyx_v_xoff;
  int __pyx_v_yoff;
  int __pyx_v_flow_dir_s;
  int __pyx_v_xi;
  int __pyx_v_yi;
  int __pyx_v_xj;
  int __pyx_v_yj;
  int __pyx_v_flow_dir_j;
  int __pyx_v_p_ij_base;
  int __pyx_v_win_xsize;
  int __pyx_v_win_ysize;
  int __pyx_v_n_dir;
  int __pyx_v_raster_x_size;
  int __pyx_v_raster_y_size;
  float __pyx_v_pet_m;
  float __pyx_v_p_m;
  float __pyx_v_qf_m;
  float __pyx_v_et0_m;
  float __pyx_v_aet_i;
  float __pyx_v_p_i;
  float __pyx_v_qf_i;
  float __pyx_v_l_i;
  float __pyx_v_l_avail_i;
  int __pyx_v_j_neighbor_end_index;
  int __pyx_v_mfd_dir_sum;
  float __pyx_v_mfd_direction_array[8];
  std::queue&lt;std::pair&lt;int,int&gt; &gt;  __pyx_v_work_queue;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_et0_m_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_qf_m_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_kc_m_raster = 0;
  PyArrayObject *__pyx_v_alpha_month_array = 0;
  time_t __pyx_v_last_log_time;
  PyObject *__pyx_v_flow_dir_raster_info = NULL;
  PyObject *__pyx_v_flow_dir_nodata = NULL;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_flow_raster = 0;
  PyObject *__pyx_v_et0_m_raster_list = NULL;
  PyObject *__pyx_v_et0_m_nodata_list = NULL;
  PyObject *__pyx_v_et0_path = NULL;
  PyObject *__pyx_v_precip_m_raster_list = NULL;
  PyObject *__pyx_v_precip_m_nodata_list = NULL;
  PyObject *__pyx_v_precip_m_path = NULL;
  PyObject *__pyx_v_qf_m_raster_list = NULL;
  PyObject *__pyx_v_qf_m_nodata_list = NULL;
  PyObject *__pyx_v_qf_m_path = NULL;
  PyObject *__pyx_v_kc_m_raster_list = NULL;
  PyObject *__pyx_v_kc_m_nodata_list = NULL;
  PyObject *__pyx_v_kc_m_path = NULL;
  double __pyx_v_target_nodata;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_li_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_li_avail_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_l_sum_avail_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_aet_raster = 0;
  PyObject *__pyx_v_offset_dict = NULL;
  PyObject *__pyx_v_current_pixel = NULL;
  double __pyx_v_l_sum_avail_i;
  long __pyx_v_upstream_defined;
  double __pyx_v_l_sum_avail_j;
  double __pyx_v_l_avail_j;
  int __pyx_v_index;
  long __pyx_v_m_index;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_precip_m_raster = NULL;
  PyObject *__pyx_v_et0_nodata = NULL;
  PyObject *__pyx_v_precip_nodata = NULL;
  PyObject *__pyx_v_qf_nodata = NULL;
  PyObject *__pyx_v_kc_nodata = NULL;
  double __pyx_v_kc_m;
  int __pyx_v_xi_n;
  int __pyx_v_yi_n;
  PyObject *__pyx_v_x = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_alpha_month_array;
  __Pyx_Buffer __pyx_pybuffer_alpha_month_array;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_local_recharge", 0);
  __pyx_pybuffer_alpha_month_array.pybuffer.buf = NULL;
  __pyx_pybuffer_alpha_month_array.refcount = 0;
  __pyx_pybuffernd_alpha_month_array.data = NULL;
  __pyx_pybuffernd_alpha_month_array.rcbuffer = &amp;__pyx_pybuffer_alpha_month_array;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core.calculate_local_recharge", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_et0_m_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_qf_m_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_kc_m_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_alpha_month_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flow_dir_raster_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flow_dir_nodata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_flow_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_et0_m_raster_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_et0_m_nodata_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_et0_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_precip_m_raster_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_precip_m_nodata_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_precip_m_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_qf_m_raster_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_qf_m_nodata_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_qf_m_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kc_m_raster_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kc_m_nodata_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kc_m_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_li_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_li_avail_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_l_sum_avail_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_aet_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_offset_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_current_pixel);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_precip_m_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_et0_nodata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_precip_nodata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_qf_nodata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kc_nodata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_1calculate_local_recharge(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_calculate_local_recharge[] = "\n    Calculate the rasters defined by equations [3]-[7].\n\n    Note all input rasters must be in the same coordinate system and\n    have the same dimensions.\n\n    Parameters:\n        precip_path_list (list): list of paths to monthly precipitation\n            rasters. (model input)\n        et0_path_list (list): path to monthly ET0 rasters. (model input)\n        qf_m_path_list (list): path to monthly quickflow rasters calculated by\n            Equation [1].\n        flow_dir_mfd_path (str): path to a PyGeoprocessing Multiple Flow\n            Direction raster indicating flow directions for this analysis.\n        alpha_month_map (dict): fraction of upslope annual available recharge\n            that is available in month m (indexed from 1).\n        beta_i (float):  fraction of the upgradient subsidy that is available\n            for downgradient evapotranspiration.\n        gamma (float): the fraction of pixel recharge that is available to\n            downgradient pixels.\n        stream_path (str): path to the stream raster where 1 is a stream,\n            0 is not, and nodata is outside of the DEM.\n        kc_path_list (str): list of rasters of the monthly crop factor for the\n            pixel.\n        target_li_path (str): created by this call, path to local recharge\n            derived from the annual water budget. (Equation 3).\n        target_li_avail_path (str): created by this call, path to raster\n            indicating available recharge to a pixel.\n        target_l_sum_avail_path (str): created by this call, the recursive\n            upstream accumulation of target_li_avail_path.\n        target_aet_path (str): created by this call, the annual actual\n            evapotranspiration.\n\n        Returns:\n            None.\n\n    ";
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_1calculate_local_recharge(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_precip_path_list = 0;
  PyObject *__pyx_v_et0_path_list = 0;
  PyObject *__pyx_v_qf_m_path_list = 0;
  PyObject *__pyx_v_flow_dir_mfd_path = 0;
  PyObject *__pyx_v_kc_path_list = 0;
  PyObject *__pyx_v_alpha_month_map = 0;
  float __pyx_v_beta_i;
  float __pyx_v_gamma;
  PyObject *__pyx_v_stream_path = 0;
  PyObject *__pyx_v_target_li_path = 0;
  PyObject *__pyx_v_target_li_avail_path = 0;
  PyObject *__pyx_v_target_l_sum_avail_path = 0;
  PyObject *__pyx_v_target_aet_path = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_local_recharge (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_precip_path_list,&amp;__pyx_n_s_et0_path_list,&amp;__pyx_n_s_qf_m_path_list,&amp;__pyx_n_s_flow_dir_mfd_path,&amp;__pyx_n_s_kc_path_list,&amp;__pyx_n_s_alpha_month_map,&amp;__pyx_n_s_beta_i,&amp;__pyx_n_s_gamma,&amp;__pyx_n_s_stream_path,&amp;__pyx_n_s_target_li_path,&amp;__pyx_n_s_target_li_avail_path,&amp;__pyx_n_s_target_l_sum_avail_path,&amp;__pyx_n_s_target_aet_path,0};
    PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_precip_path_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_et0_path_list)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 1); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_qf_m_path_list)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 2); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flow_dir_mfd_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 3); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kc_path_list)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 4); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alpha_month_map)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 5); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_beta_i)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 6); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gamma)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 7); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_stream_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 8); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_li_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 9); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_li_avail_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 10); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_l_sum_avail_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 11); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (likely((values[12] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_aet_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, 12); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calculate_local_recharge") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 13) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
    }
    __pyx_v_precip_path_list = values[0];
    __pyx_v_et0_path_list = values[1];
    __pyx_v_qf_m_path_list = values[2];
    __pyx_v_flow_dir_mfd_path = values[3];
    __pyx_v_kc_path_list = values[4];
    __pyx_v_alpha_month_map = values[5];
    __pyx_v_beta_i = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_beta_i == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L3_error)</span>
    __pyx_v_gamma = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_gamma == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L3_error)</span>
    __pyx_v_stream_path = values[8];
    __pyx_v_target_li_path = values[9];
    __pyx_v_target_li_avail_path = values[10];
    __pyx_v_target_l_sum_avail_path = values[11];
    __pyx_v_target_aet_path = values[12];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_local_recharge", 1, 13, 13, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core.calculate_local_recharge", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_calculate_local_recharge(__pyx_self, __pyx_v_precip_path_list, __pyx_v_et0_path_list, __pyx_v_qf_m_path_list, __pyx_v_flow_dir_mfd_path, __pyx_v_kc_path_list, __pyx_v_alpha_month_map, __pyx_v_beta_i, __pyx_v_gamma, __pyx_v_stream_path, __pyx_v_target_li_path, __pyx_v_target_li_avail_path, __pyx_v_target_l_sum_avail_path, __pyx_v_target_aet_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_calculate_local_recharge(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_precip_path_list, PyObject *__pyx_v_et0_path_list, PyObject *__pyx_v_qf_m_path_list, PyObject *__pyx_v_flow_dir_mfd_path, PyObject *__pyx_v_kc_path_list, PyObject *__pyx_v_alpha_month_map, float __pyx_v_beta_i, float __pyx_v_gamma, PyObject *__pyx_v_stream_path, PyObject *__pyx_v_target_li_path, PyObject *__pyx_v_target_li_avail_path, PyObject *__pyx_v_target_l_sum_avail_path, PyObject *__pyx_v_target_aet_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_local_recharge", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_calculate_local_recharge(__pyx_v_precip_path_list, __pyx_v_et0_path_list, __pyx_v_qf_m_path_list, __pyx_v_flow_dir_mfd_path, __pyx_v_kc_path_list, __pyx_v_alpha_month_map, __pyx_v_beta_i, __pyx_v_gamma, __pyx_v_stream_path, __pyx_v_target_li_path, __pyx_v_target_li_avail_path, __pyx_v_target_l_sum_avail_path, __pyx_v_target_aet_path, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core.calculate_local_recharge", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">373</span>:         <span class="n">precip_path_list</span><span class="p">,</span> <span class="n">et0_path_list</span><span class="p">,</span> <span class="n">qf_m_path_list</span><span class="p">,</span> <span class="n">flow_dir_mfd_path</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>:         <span class="n">kc_path_list</span><span class="p">,</span> <span class="n">alpha_month_map</span><span class="p">,</span> <span class="nb">float</span> <span class="n">beta_i</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">stream_path</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>:         <span class="n">target_li_path</span><span class="p">,</span> <span class="n">target_li_avail_path</span><span class="p">,</span> <span class="n">target_l_sum_avail_path</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>:         <span class="n">target_aet_path</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">377</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>: <span class="sd">    Calculate the rasters defined by equations [3]-[7].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: <span class="sd">    Note all input rasters must be in the same coordinate system and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">381</span>: <span class="sd">    have the same dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">383</span>: <span class="sd">    Parameters:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">384</span>: <span class="sd">        precip_path_list (list): list of paths to monthly precipitation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: <span class="sd">            rasters. (model input)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>: <span class="sd">        et0_path_list (list): path to monthly ET0 rasters. (model input)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">387</span>: <span class="sd">        qf_m_path_list (list): path to monthly quickflow rasters calculated by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">388</span>: <span class="sd">            Equation [1].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>: <span class="sd">        flow_dir_mfd_path (str): path to a PyGeoprocessing Multiple Flow</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">390</span>: <span class="sd">            Direction raster indicating flow directions for this analysis.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>: <span class="sd">        alpha_month_map (dict): fraction of upslope annual available recharge</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>: <span class="sd">            that is available in month m (indexed from 1).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>: <span class="sd">        beta_i (float):  fraction of the upgradient subsidy that is available</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">394</span>: <span class="sd">            for downgradient evapotranspiration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">395</span>: <span class="sd">        gamma (float): the fraction of pixel recharge that is available to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">396</span>: <span class="sd">            downgradient pixels.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">397</span>: <span class="sd">        stream_path (str): path to the stream raster where 1 is a stream,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">398</span>: <span class="sd">            0 is not, and nodata is outside of the DEM.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">399</span>: <span class="sd">        kc_path_list (str): list of rasters of the monthly crop factor for the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">400</span>: <span class="sd">            pixel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">401</span>: <span class="sd">        target_li_path (str): created by this call, path to local recharge</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">402</span>: <span class="sd">            derived from the annual water budget. (Equation 3).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">403</span>: <span class="sd">        target_li_avail_path (str): created by this call, path to raster</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>: <span class="sd">            indicating available recharge to a pixel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">405</span>: <span class="sd">        target_l_sum_avail_path (str): created by this call, the recursive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">406</span>: <span class="sd">            upstream accumulation of target_li_avail_path.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">407</span>: <span class="sd">        target_aet_path (str): created by this call, the annual actual</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">408</span>: <span class="sd">            evapotranspiration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: <span class="sd">        Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">411</span>: <span class="sd">            None.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">414</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i_n</span><span class="p">,</span> <span class="nf">flow_dir_mfd</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">peak_pixel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xs</span><span class="p">,</span> <span class="nf">ys</span><span class="p">,</span> <span class="nf">xs_root</span><span class="p">,</span> <span class="nf">ys_root</span><span class="p">,</span> <span class="nf">xoff</span><span class="p">,</span> <span class="nf">yoff</span><span class="p">,</span> <span class="nf">flow_dir_s</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xi</span><span class="p">,</span> <span class="nf">yi</span><span class="p">,</span> <span class="nf">xj</span><span class="p">,</span> <span class="nf">yj</span><span class="p">,</span> <span class="nf">flow_dir_j</span><span class="p">,</span> <span class="nf">p_ij_base</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">win_xsize</span><span class="p">,</span> <span class="nf">win_ysize</span><span class="p">,</span> <span class="nf">n_dir</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">raster_x_size</span><span class="p">,</span> <span class="nf">raster_y_size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">420</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">pet_m</span><span class="p">,</span> <span class="nf">p_m</span><span class="p">,</span> <span class="nf">qf_m</span><span class="p">,</span> <span class="nf">et0_m</span><span class="p">,</span> <span class="nf">aet_i</span><span class="p">,</span> <span class="nf">p_i</span><span class="p">,</span> <span class="nf">qf_i</span><span class="p">,</span> <span class="nf">l_i</span><span class="p">,</span> <span class="nf">l_avail_i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">j_neighbor_end_index</span><span class="p">,</span> <span class="nf">mfd_dir_sum</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="kt">mfd_direction_array</span>[8]</pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>:     <span class="k">cdef</span> <span class="kt">queue</span>[<span class="kt">pair</span>[<span class="nf">int</span><span class="p">,</span> <span class="kt">int</span>]] <span class="nf">work_queue</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">et0_m_raster</span><span class="p">,</span> <span class="nf">qf_m_raster</span><span class="p">,</span> <span class="nf">kc_m_raster</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="kt">numpy</span>.<span class="nf">npy_float32</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">alpha_month_array</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:         <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 429, __pyx_L1_error)</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn_npy_float32, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_alpha_month_array = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_alpha_month_array.diminfo[0].strides = __pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_alpha_month_array.diminfo[0].shape = __pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_alpha_month_array = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>:             <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">alpha_month_map</span><span class="o">.</span><span class="n">items</span><span class="p">())],</span></pre>
<pre class='cython code score-52 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_alpha_month_map, __pyx_n_s_items);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyList_Sort</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  if (unlikely(__pyx_t_3 == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">431</span>:             <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 431, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 431, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>:     <span class="c"># used for time-delayed logging</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>:     <span class="k">cdef</span> <span class="kt">time_t</span> <span class="nf">last_log_time</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">435</span>:     <span class="n">last_log_time</span> <span class="o">=</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_last_log_time = time(NULL);
</pre><pre class="cython line score-0">&#xA0;<span class="">436</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>:     <span class="c"># we know the PyGeoprocessing MFD raster flow dir type is a 32 bit int.</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">438</span>:     <span class="n">flow_dir_raster_info</span> <span class="o">=</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">flow_dir_mfd_path</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 438, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_v_flow_dir_mfd_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 438, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_flow_dir_raster_info = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">439</span>:     <span class="n">flow_dir_nodata</span> <span class="o">=</span> <span class="n">flow_dir_raster_info</span><span class="p">[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_flow_dir_raster_info, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 439, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 439, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_flow_dir_nodata = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">440</span>:     <span class="n">raster_x_size</span><span class="p">,</span> <span class="n">raster_y_size</span> <span class="o">=</span> <span class="n">flow_dir_raster_info</span><span class="p">[</span><span class="s">&#39;raster_size&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-62 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_flow_dir_raster_info, __pyx_n_s_raster_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 440, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 440, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 440, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_10 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;
    index = 0; __pyx_t_4 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    index = 1; __pyx_t_1 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_10(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>
    __pyx_t_10 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_10 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_11 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_raster_x_size = __pyx_t_11;
  __pyx_v_raster_y_size = __pyx_t_12;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">441</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">flow_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_flow_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">442</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>:     <span class="n">et0_m_raster_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_et0_m_raster_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:     <span class="n">et0_m_nodata_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_et0_m_nodata_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>:     <span class="k">for</span> <span class="n">et0_path</span> <span class="ow">in</span> <span class="n">et0_path_list</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_et0_path_list)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_et0_path_list)) {
    __pyx_t_1 = __pyx_v_et0_path_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_et0_path_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_13(__pyx_t_1);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_et0_path, __pyx_t_5);
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">446</span>:         <span class="n">et0_m_raster_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">et0_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_et0_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_et0_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_et0_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_0);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_et0_m_raster_list, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 446, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>:         <span class="n">et0_m_nodata_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_et0_m_nodata_list, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 447, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>:             <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">et0_path</span><span class="p">)[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_v_et0_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_et0_path);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_4, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">449</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:     <span class="n">precip_m_raster_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_precip_m_raster_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:     <span class="n">precip_m_nodata_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_precip_m_nodata_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:     <span class="k">for</span> <span class="n">precip_m_path</span> <span class="ow">in</span> <span class="n">precip_path_list</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_precip_path_list)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_precip_path_list)) {
    __pyx_t_1 = __pyx_v_precip_path_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_precip_path_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_13(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_precip_m_path, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:         <span class="n">precip_m_raster_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">precip_m_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-17 '>    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_precip_m_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_precip_m_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_precip_m_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_precip_m_raster_list, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:         <span class="n">precip_m_nodata_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_precip_m_nodata_list, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 454, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:             <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">precip_m_path</span><span class="p">)[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_precip_m_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_precip_m_path);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_2, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">456</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:     <span class="n">qf_m_raster_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_qf_m_raster_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:     <span class="n">qf_m_nodata_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_qf_m_nodata_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:     <span class="k">for</span> <span class="n">qf_m_path</span> <span class="ow">in</span> <span class="n">qf_m_path_list</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_qf_m_path_list)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_qf_m_path_list)) {
    __pyx_t_1 = __pyx_v_qf_m_path_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_qf_m_path_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_13(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_qf_m_path, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:         <span class="n">qf_m_raster_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">qf_m_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-17 '>    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_qf_m_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_qf_m_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_qf_m_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_0);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_qf_m_raster_list, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:         <span class="n">qf_m_nodata_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_qf_m_nodata_list, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 461, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:             <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">qf_m_path</span><span class="p">)[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_qf_m_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_qf_m_path);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_5, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">463</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>:     <span class="n">kc_m_raster_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_kc_m_raster_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>:     <span class="n">kc_m_nodata_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_kc_m_nodata_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:     <span class="k">for</span> <span class="n">kc_m_path</span> <span class="ow">in</span> <span class="n">kc_path_list</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_kc_path_list)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_kc_path_list)) {
    __pyx_t_1 = __pyx_v_kc_path_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_kc_path_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_13(__pyx_t_1);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_kc_m_path, __pyx_t_5);
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:         <span class="n">kc_m_raster_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">kc_m_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kc_m_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kc_m_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_kc_m_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_0);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_kc_m_raster_list, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 467, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:         <span class="n">kc_m_nodata_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_kc_m_nodata_list, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 468, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:             <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">kc_m_path</span><span class="p">)[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_v_kc_m_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_kc_m_path);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_4, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">470</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:     <span class="n">target_nodata</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e32</span></pre>
<pre class='cython code score-0 '>  __pyx_v_target_nodata = -1e32;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_li_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_li_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_target_li_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_li_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span> <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:         <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-19 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_fill_value_list, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_li_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_li_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_li_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_target_li_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 475, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_target_li_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">476</span>:         <span class="n">target_li_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">477</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_li_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_li_avail_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_target_li_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_li_avail_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:         <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span> <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_fill_value_list, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_li_avail_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_li_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_li_avail_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_target_li_avail_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_target_li_avail_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">482</span>:         <span class="n">target_li_avail_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">483</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_l_sum_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_l_sum_avail_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_target_l_sum_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_l_sum_avail_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span> <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_fill_value_list, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_l_sum_avail_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_l_sum_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_l_sum_avail_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_target_l_sum_avail_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_target_l_sum_avail_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">488</span>:         <span class="n">target_l_sum_avail_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">489</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_aet_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_aet_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_target_aet_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_2);
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_aet_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span> <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:         <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_fill_value_list, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 492, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_aet_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_aet_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_aet_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_target_aet_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_target_aet_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">494</span>:         <span class="n">target_aet_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:     <span class="k">for</span> <span class="n">offset_dict</span> <span class="ow">in</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">iterblocks</span><span class="p">(</span></pre>
<pre class='cython code score-60 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_iterblocks);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_13 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 497, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 497, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_13(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 497, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_offset_dict, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:             <span class="p">(</span><span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="n">offset_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">largest_block</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_offset_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 498, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_largest_block, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 498, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>:         <span class="n">win_xsize</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;win_xsize&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_win_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 499, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_win_xsize = __pyx_t_12;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:         <span class="n">win_ysize</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;win_ysize&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_win_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 500, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_win_ysize = __pyx_t_12;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:         <span class="n">xoff</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;xoff&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_xoff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 501, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_xoff = __pyx_t_12;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:         <span class="n">yoff</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;yoff&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_yoff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_yoff = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">503</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:         <span class="k">if</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span> <span class="o">-</span> <span class="n">last_log_time</span> <span class="o">&gt;</span> <span class="mf">5.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = (((time(NULL) - __pyx_v_last_log_time) &gt; 5.0) != 0);
    if (__pyx_t_14) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:             <span class="n">last_log_time</span> <span class="o">=</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_last_log_time = time(NULL);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:             <span class="n">current_pixel</span> <span class="o">=</span> <span class="n">xoff</span> <span class="o">+</span> <span class="n">yoff</span> <span class="o">*</span> <span class="n">raster_x_size</span></pre>
<pre class='cython code score-3 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_xoff + (__pyx_v_yoff * __pyx_v_raster_x_size)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_current_pixel, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:             <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_LOGGER);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_info);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">508</span>:                 <span class="s">&#39;peak point detection </span><span class="si">%.2f%%</span><span class="s"> complete&#39;</span><span class="p">,</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:                 <span class="mf">100.0</span> <span class="o">*</span> <span class="n">current_pixel</span> <span class="o">/</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;(</span></pre>
<pre class='cython code score-53 '>      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_100_0, __pyx_v_current_pixel);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)(__pyx_v_raster_x_size * __pyx_v_raster_y_size)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_12 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_12 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_kp_s_peak_point_detection_2f_complete, __pyx_t_6};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_kp_s_peak_point_detection_2f_complete, __pyx_t_6};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_peak_point_detection_2f_complete);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_peak_point_detection_2f_complete);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_12, __pyx_kp_s_peak_point_detection_2f_complete);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_12, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">510</span>:                     <span class="n">raster_x_size</span> <span class="o">*</span> <span class="n">raster_y_size</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">511</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">512</span>:         <span class="c"># search block for a peak pixel where no other pixel drains to it.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:         <span class="k">for</span> <span class="n">ys</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_ysize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_win_ysize;
    __pyx_t_11 = __pyx_t_12;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_11; __pyx_t_15+=1) {
      __pyx_v_ys = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:             <span class="n">ys_root</span> <span class="o">=</span> <span class="n">yoff</span><span class="o">+</span><span class="n">ys</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ys_root = (__pyx_v_yoff + __pyx_v_ys);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:             <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_xsize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_win_xsize;
      __pyx_t_17 = __pyx_t_16;
      for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_xs = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:                 <span class="n">xs_root</span> <span class="o">=</span> <span class="n">xoff</span><span class="o">+</span><span class="n">xs</span></pre>
<pre class='cython code score-0 '>        __pyx_v_xs_root = (__pyx_v_xoff + __pyx_v_xs);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:                 <span class="n">flow_dir_s</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xs_root</span><span class="p">,</span> <span class="n">ys_root</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_flow_dir_s = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_raster, __pyx_v_xs_root, __pyx_v_ys_root));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:                 <span class="k">if</span> <span class="n">flow_dir_s</span> <span class="o">==</span> <span class="n">flow_dir_nodata</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_flow_dir_s);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_v_flow_dir_nodata, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_14 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 518, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (__pyx_t_14) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">519</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L20_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">520</span>:                 <span class="c"># search neighbors for downhill or nodata</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:                 <span class="n">peak_pixel</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_peak_pixel = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:                 <span class="k">for</span> <span class="n">n_dir</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        for (__pyx_t_19 = 0; __pyx_t_19 &lt; 8; __pyx_t_19+=1) {
          __pyx_v_n_dir = __pyx_t_19;
</pre><pre class="cython line score-0">&#xA0;<span class="">523</span>:                     <span class="c"># searching around the pattern:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>:                     <span class="c"># 321</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">525</span>:                     <span class="c"># 4x0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">526</span>:                     <span class="c"># 567</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:                     <span class="n">xj</span> <span class="o">=</span> <span class="n">xs_root</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_v_xj = (__pyx_v_xs_root + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_n_dir)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:                     <span class="n">yj</span> <span class="o">=</span> <span class="n">ys_root</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_v_yj = (__pyx_v_ys_root + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_n_dir) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:                     <span class="k">if</span> <span class="p">(</span><span class="n">xj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xj</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>          __pyx_t_20 = ((__pyx_v_xj &lt; 0) != 0);
          if (!__pyx_t_20) {
          } else {
            __pyx_t_14 = __pyx_t_20;
            goto __pyx_L26_bool_binop_done;
          }
          __pyx_t_20 = ((__pyx_v_xj &gt;= __pyx_v_raster_x_size) != 0);
          if (!__pyx_t_20) {
          } else {
            __pyx_t_14 = __pyx_t_20;
            goto __pyx_L26_bool_binop_done;
          }
/* … */
          if (__pyx_t_14) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:                             <span class="n">yj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yj</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_20 = ((__pyx_v_yj &lt; 0) != 0);
          if (!__pyx_t_20) {
          } else {
            __pyx_t_14 = __pyx_t_20;
            goto __pyx_L26_bool_binop_done;
          }
          __pyx_t_20 = ((__pyx_v_yj &gt;= __pyx_v_raster_y_size) != 0);
          __pyx_t_14 = __pyx_t_20;
          __pyx_L26_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L23_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:                     <span class="n">flow_dir_j</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_flow_dir_j = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_raster, __pyx_v_xj, __pyx_v_yj));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">533</span>:                     <span class="k">if</span> <span class="p">(</span><span class="mf">0</span><span class="n">xF</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_dir_j</span> <span class="o">&gt;&gt;</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = ((0xF &amp; (__pyx_v_flow_dir_j &gt;&gt; (4 * (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_FLOW_DIR_REVERSE_DIRECTION[__pyx_v_n_dir])))) != 0);
          if (__pyx_t_14) {
/* … */
          }
          __pyx_L23_continue:;
        }
        __pyx_L24_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">534</span>:                             <span class="mf">4</span> <span class="o">*</span> <span class="n">FLOW_DIR_REVERSE_DIRECTION</span><span class="p">[</span><span class="n">n_dir</span><span class="p">]))):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:                         <span class="c"># pixel flows inward, not a peak</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:                         <span class="n">peak_pixel</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_v_peak_pixel = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L24_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">538</span>:                 <span class="k">if</span> <span class="n">peak_pixel</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_14 = (__pyx_v_peak_pixel != 0);
        if (__pyx_t_14) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:                     <span class="n">work_queue</span><span class="o">.</span><span class="n">push</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_v_work_queue.push(__pyx_t_21);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">540</span>:                         <span class="n">pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">](</span><span class="n">xs_root</span><span class="p">,</span> <span class="n">ys_root</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>          try {
            __pyx_t_21 = std::pair&lt;int,int&gt; (__pyx_v_xs_root, __pyx_v_ys_root);
          } catch(...) {
            __Pyx_CppExn2PyErr();
            <span class='error_goto'>__PYX_ERR(0, 540, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">541</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">542</span>:                 <span class="k">while</span> <span class="n">work_queue</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_14 = ((__pyx_v_work_queue.size() &gt; 0) != 0);
          if (!__pyx_t_14) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">543</span>:                     <span class="n">xi</span> <span class="o">=</span> <span class="n">work_queue</span><span class="o">.</span><span class="n">front</span><span class="p">()</span><span class="o">.</span><span class="n">first</span></pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_work_queue.front().first;
          __pyx_v_xi = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">544</span>:                     <span class="n">yi</span> <span class="o">=</span> <span class="n">work_queue</span><span class="o">.</span><span class="n">front</span><span class="p">()</span><span class="o">.</span><span class="n">second</span></pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_work_queue.front().second;
          __pyx_v_yi = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">545</span>:                     <span class="n">work_queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>          __pyx_v_work_queue.pop();
</pre><pre class="cython line score-0">&#xA0;<span class="">546</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">547</span>:                     <span class="n">l_sum_avail_i</span> <span class="o">=</span> <span class="n">target_l_sum_avail_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_l_sum_avail_i = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_target_l_sum_avail_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">548</span>:                     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_close</span><span class="p">(</span><span class="n">l_sum_avail_i</span><span class="p">,</span> <span class="n">target_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = ((!(__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_l_sum_avail_i, __pyx_v_target_nodata) != 0)) != 0);
          if (__pyx_t_14) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">549</span>:                         <span class="c"># already defined</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">550</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L32_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>:                     <span class="c"># Equation 7, calculate L_sum_avail_i if possible, skip</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>:                     <span class="c"># otherwise</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">554</span>:                     <span class="n">upstream_defined</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_upstream_defined = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">555</span>:                     <span class="c"># initialize to 0 so we indicate we haven&#39;t tracked any</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">556</span>:                     <span class="c"># mfd values yet</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">557</span>:                     <span class="n">j_neighbor_end_index</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_j_neighbor_end_index = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>:                     <span class="n">mfd_dir_sum</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_mfd_dir_sum = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">559</span>:                     <span class="k">for</span> <span class="n">n_dir</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_19 = 0; __pyx_t_19 &lt; 8; __pyx_t_19+=1) {
            __pyx_v_n_dir = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:                         <span class="k">if</span> <span class="ow">not</span> <span class="n">upstream_defined</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = ((!(__pyx_v_upstream_defined != 0)) != 0);
            if (__pyx_t_14) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:                             <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L36_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>:                         <span class="c"># searching around the pattern:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>:                         <span class="c"># 321</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>:                         <span class="c"># 4x0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">565</span>:                         <span class="c"># 567</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:                         <span class="n">xj</span> <span class="o">=</span> <span class="n">xi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_xj = (__pyx_v_xi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_n_dir)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:                         <span class="n">yj</span> <span class="o">=</span> <span class="n">yi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_yj = (__pyx_v_yi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_n_dir) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:                         <span class="k">if</span> <span class="p">(</span><span class="n">xj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xj</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = ((__pyx_v_xj &lt; 0) != 0);
            if (!__pyx_t_20) {
            } else {
              __pyx_t_14 = __pyx_t_20;
              goto __pyx_L39_bool_binop_done;
            }
            __pyx_t_20 = ((__pyx_v_xj &gt;= __pyx_v_raster_x_size) != 0);
            if (!__pyx_t_20) {
            } else {
              __pyx_t_14 = __pyx_t_20;
              goto __pyx_L39_bool_binop_done;
            }
/* … */
            if (__pyx_t_14) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:                                 <span class="n">yj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yj</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = ((__pyx_v_yj &lt; 0) != 0);
            if (!__pyx_t_20) {
            } else {
              __pyx_t_14 = __pyx_t_20;
              goto __pyx_L39_bool_binop_done;
            }
            __pyx_t_20 = ((__pyx_v_yj &gt;= __pyx_v_raster_y_size) != 0);
            __pyx_t_14 = __pyx_t_20;
            __pyx_L39_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:                             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L35_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">571</span>:                         <span class="n">p_ij_base</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">572</span>:                                 <span class="mf">4</span> <span class="o">*</span> <span class="n">FLOW_DIR_REVERSE_DIRECTION</span><span class="p">[</span><span class="n">n_dir</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">xF</span></pre>
<pre class='cython code score-0 '>            __pyx_v_p_ij_base = ((((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_raster, __pyx_v_xj, __pyx_v_yj)) &gt;&gt; (4 * (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_FLOW_DIR_REVERSE_DIRECTION[__pyx_v_n_dir]))) &amp; 0xF);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">573</span>:                         <span class="k">if</span> <span class="n">p_ij_base</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = (__pyx_v_p_ij_base != 0);
            if (__pyx_t_14) {
/* … */
            }
            __pyx_L35_continue:;
          }
          __pyx_L36_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:                             <span class="n">mfd_dir_sum</span> <span class="o">+=</span> <span class="n">p_ij_base</span></pre>
<pre class='cython code score-0 '>              __pyx_v_mfd_dir_sum = (__pyx_v_mfd_dir_sum + __pyx_v_p_ij_base);
</pre><pre class="cython line score-0">&#xA0;<span class="">575</span>:                             <span class="c"># pixel flows inward, check upstream</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">576</span>:                             <span class="n">l_sum_avail_j</span> <span class="o">=</span> <span class="n">target_l_sum_avail_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>              __pyx_v_l_sum_avail_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_target_l_sum_avail_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0">&#xA0;<span class="">577</span>:                                 <span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:                             <span class="k">if</span> <span class="n">is_close</span><span class="p">(</span><span class="n">l_sum_avail_j</span><span class="p">,</span> <span class="n">target_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>              __pyx_t_14 = (__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_l_sum_avail_j, __pyx_v_target_nodata) != 0);
              if (__pyx_t_14) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">579</span>:                                 <span class="n">upstream_defined</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>                __pyx_v_upstream_defined = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:                                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>                goto __pyx_L36_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:                             <span class="n">l_avail_j</span> <span class="o">=</span> <span class="n">target_li_avail_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>              __pyx_v_l_avail_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_target_li_avail_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0">&#xA0;<span class="">582</span>:                                 <span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">583</span>:                             <span class="c"># A step of Equation 7</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:                             <span class="n">mfd_direction_array</span><span class="p">[</span><span class="n">j_neighbor_end_index</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>              (__pyx_v_mfd_direction_array[__pyx_v_j_neighbor_end_index]) = ((__pyx_v_l_sum_avail_j + __pyx_v_l_avail_j) * __pyx_v_p_ij_base);
</pre><pre class="cython line score-0">&#xA0;<span class="">585</span>:                                 <span class="n">l_sum_avail_j</span> <span class="o">+</span> <span class="n">l_avail_j</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_ij_base</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:                             <span class="n">j_neighbor_end_index</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>              __pyx_v_j_neighbor_end_index = (__pyx_v_j_neighbor_end_index + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">587</span>:                     <span class="c"># calculate l_sum_avail_i by summing all the valid</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">588</span>:                     <span class="c"># directions then normalizing by the sum of the mfd</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">589</span>:                     <span class="c"># direction weights (Equation 8)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:                     <span class="k">if</span> <span class="n">upstream_defined</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = (__pyx_v_upstream_defined != 0);
          if (__pyx_t_14) {
/* … */
            goto __pyx_L45;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:                         <span class="n">l_sum_avail_i</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>            __pyx_v_l_sum_avail_i = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">592</span>:                         <span class="c"># Equation 7</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">593</span>:                         <span class="k">if</span> <span class="n">j_neighbor_end_index</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = ((__pyx_v_j_neighbor_end_index &gt; 0) != 0);
            if (__pyx_t_14) {
/* … */
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">594</span>:                             <span class="c"># we can have no upstream, and then why would we</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">595</span>:                             <span class="c"># divide?</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:                             <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j_neighbor_end_index</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>              __pyx_t_19 = __pyx_v_j_neighbor_end_index;
              __pyx_t_22 = __pyx_t_19;
              for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
                __pyx_v_index = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">597</span>:                                 <span class="n">l_sum_avail_i</span> <span class="o">+=</span> <span class="n">mfd_direction_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                __pyx_v_l_sum_avail_i = (__pyx_v_l_sum_avail_i + (__pyx_v_mfd_direction_array[__pyx_v_index]));
              }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">598</span>:                             <span class="n">l_sum_avail_i</span> <span class="o">/=</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span><span class="n">mfd_dir_sum</span></pre>
<pre class='cython code score-5 '>              if (unlikely(((float)__pyx_v_mfd_dir_sum) == 0)) {
                <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
                <span class='error_goto'>__PYX_ERR(0, 598, __pyx_L1_error)</span>
              }
              __pyx_v_l_sum_avail_i = (__pyx_v_l_sum_avail_i / ((float)__pyx_v_mfd_dir_sum));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">599</span>:                         <span class="n">target_l_sum_avail_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">l_sum_avail_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_l_sum_avail_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_l_sum_avail_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">600</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">601</span>:                         <span class="c"># if not defined, we&#39;ll get it on another pass</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">602</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            goto __pyx_L32_continue;
          }
          __pyx_L45:;
</pre><pre class="cython line score-0">&#xA0;<span class="">603</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:                     <span class="n">aet_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_aet_i = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">605</span>:                     <span class="n">p_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_p_i = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:                     <span class="n">qf_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_qf_i = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">607</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">608</span>:                     <span class="k">for</span> <span class="n">m_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">12</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_24 = 0; __pyx_t_24 &lt; 12; __pyx_t_24+=1) {
            __pyx_v_m_index = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">609</span>:                         <span class="n">precip_m_raster</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">610</span>:                             <span class="o">&lt;</span><span class="n">_ManagedRaster</span><span class="o">?&gt;</span><span class="n">precip_m_raster_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_precip_m_raster_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 610, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster)))) <span class='error_goto'>__PYX_ERR(0, 610, __pyx_L1_error)</span>
            __pyx_t_1 = __pyx_t_5;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_precip_m_raster, ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1));
            __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">611</span>:                         <span class="n">qf_m_raster</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:                             <span class="o">&lt;</span><span class="n">_ManagedRaster</span><span class="o">?&gt;</span><span class="n">qf_m_raster_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_qf_m_raster_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster)))) <span class='error_goto'>__PYX_ERR(0, 612, __pyx_L1_error)</span>
            __pyx_t_5 = __pyx_t_1;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_qf_m_raster, ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_5));
            __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">613</span>:                         <span class="n">et0_m_raster</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">614</span>:                             <span class="o">&lt;</span><span class="n">_ManagedRaster</span><span class="o">?&gt;</span><span class="n">et0_m_raster_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_et0_m_raster_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster)))) <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>
            __pyx_t_1 = __pyx_t_5;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_et0_m_raster, ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1));
            __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">615</span>:                         <span class="n">kc_m_raster</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">616</span>:                             <span class="o">&lt;</span><span class="n">_ManagedRaster</span><span class="o">?&gt;</span><span class="n">kc_m_raster_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_kc_m_raster_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster)))) <span class='error_goto'>__PYX_ERR(0, 616, __pyx_L1_error)</span>
            __pyx_t_5 = __pyx_t_1;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_kc_m_raster, ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_5));
            __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">617</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>:                         <span class="n">et0_nodata</span> <span class="o">=</span> <span class="n">et0_m_nodata_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">]</span></pre>
<pre class='cython code score-3 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_et0_m_nodata_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_et0_nodata, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:                         <span class="n">precip_nodata</span> <span class="o">=</span> <span class="n">precip_m_nodata_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">]</span></pre>
<pre class='cython code score-3 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_precip_m_nodata_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_precip_nodata, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">620</span>:                         <span class="n">qf_nodata</span> <span class="o">=</span> <span class="n">qf_m_nodata_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">]</span></pre>
<pre class='cython code score-3 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_qf_m_nodata_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 620, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_qf_nodata, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:                         <span class="n">kc_nodata</span> <span class="o">=</span> <span class="n">kc_m_nodata_list</span><span class="p">[</span><span class="n">m_index</span><span class="p">]</span></pre>
<pre class='cython code score-3 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_kc_m_nodata_list, __pyx_v_m_index, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_kc_nodata, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">622</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">623</span>:                         <span class="c"># make sure that user input nodata values are defined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">624</span>:                         <span class="c"># precipitation and evapotranspiration data should </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">625</span>:                         <span class="c"># always be non-negative</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:                         <span class="k">if</span> <span class="n">precip_nodata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = (__pyx_v_precip_nodata == Py_None);
            __pyx_t_20 = (__pyx_t_14 != 0);
            if (__pyx_t_20) {
/* … */
            }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:                             <span class="n">precip_nodata</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-2 '>              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_precip_nodata, __pyx_int_neg_1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:                         <span class="k">if</span> <span class="n">et0_nodata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = (__pyx_v_et0_nodata == Py_None);
            __pyx_t_14 = (__pyx_t_20 != 0);
            if (__pyx_t_14) {
/* … */
            }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">629</span>:                             <span class="n">et0_nodata</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-2 '>              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_et0_nodata, __pyx_int_neg_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">630</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:                         <span class="n">p_m</span> <span class="o">=</span> <span class="n">precip_m_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_p_m = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_precip_m_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:                         <span class="k">if</span> <span class="ow">not</span> <span class="n">is_close</span><span class="p">(</span><span class="n">p_m</span><span class="p">,</span> <span class="n">precip_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_precip_nodata); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>
            __pyx_t_14 = ((!(__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_p_m, __pyx_t_25) != 0)) != 0);
            if (__pyx_t_14) {
/* … */
              goto __pyx_L53;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:                             <span class="n">p_i</span> <span class="o">+=</span> <span class="n">p_m</span></pre>
<pre class='cython code score-0 '>              __pyx_v_p_i = (__pyx_v_p_i + __pyx_v_p_m);
</pre><pre class="cython line score-0">&#xA0;<span class="">634</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:                             <span class="n">p_m</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_p_m = 0.0;
            }
            __pyx_L53:;
</pre><pre class="cython line score-0">&#xA0;<span class="">636</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:                         <span class="n">qf_m</span> <span class="o">=</span> <span class="n">qf_m_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_qf_m = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_qf_m_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:                         <span class="k">if</span> <span class="ow">not</span> <span class="n">is_close</span><span class="p">(</span><span class="n">qf_m</span><span class="p">,</span> <span class="n">qf_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_qf_nodata); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
            __pyx_t_14 = ((!(__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_qf_m, __pyx_t_25) != 0)) != 0);
            if (__pyx_t_14) {
/* … */
              goto __pyx_L54;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:                             <span class="n">qf_i</span> <span class="o">+=</span> <span class="n">qf_m</span></pre>
<pre class='cython code score-0 '>              __pyx_v_qf_i = (__pyx_v_qf_i + __pyx_v_qf_m);
</pre><pre class="cython line score-0">&#xA0;<span class="">640</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">641</span>:                             <span class="n">qf_m</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_qf_m = 0.0;
            }
            __pyx_L54:;
</pre><pre class="cython line score-0">&#xA0;<span class="">642</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:                         <span class="n">kc_m</span> <span class="o">=</span> <span class="n">kc_m_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_kc_m = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_kc_m_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">644</span>:                         <span class="n">pet_m</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_v_pet_m = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">645</span>:                         <span class="n">et0_m</span> <span class="o">=</span> <span class="n">et0_m_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_et0_m = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_et0_m_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">646</span>:                         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = ((!__pyx_t_14) != 0);
            if (__pyx_t_20) {
/* … */
            }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">647</span>:                                 <span class="n">is_close</span><span class="p">(</span><span class="n">kc_m</span><span class="p">,</span> <span class="n">kc_nodata</span><span class="p">)</span> <span class="ow">or</span></pre>
<pre class='cython code score-10 '>            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_kc_nodata); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
            __pyx_t_20 = (__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_kc_m, __pyx_t_25) != 0);
            if (!__pyx_t_20) {
            } else {
              __pyx_t_14 = __pyx_t_20;
              goto __pyx_L56_bool_binop_done;
            }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">648</span>:                                 <span class="n">is_close</span><span class="p">(</span><span class="n">et0_m</span><span class="p">,</span> <span class="n">et0_nodata</span><span class="p">)):</span></pre>
<pre class='cython code score-10 '>            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_et0_nodata); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>
            __pyx_t_20 = (__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_et0_m, __pyx_t_25) != 0);
            __pyx_t_14 = __pyx_t_20;
            __pyx_L56_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">649</span>:                             <span class="c"># Equation 6</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">650</span>:                             <span class="n">pet_m</span> <span class="o">=</span> <span class="n">kc_m</span> <span class="o">*</span> <span class="n">et0_m</span></pre>
<pre class='cython code score-0 '>              __pyx_v_pet_m = (__pyx_v_kc_m * __pyx_v_et0_m);
</pre><pre class="cython line score-0">&#xA0;<span class="">651</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">652</span>:                         <span class="c"># Equation 4/5</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">653</span>:                         <span class="n">aet_i</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>            __pyx_v_aet_i = (__pyx_v_aet_i + __pyx_t_28);
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">654</span>:                             <span class="n">pet_m</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>            __pyx_t_27 = __pyx_v_pet_m;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">655</span>:                             <span class="n">p_m</span> <span class="o">-</span> <span class="n">qf_m</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>            __pyx_t_25 = ((__pyx_v_p_m - __pyx_v_qf_m) + (((*__Pyx_BufPtrStrided1d(npy_float32 *, __pyx_pybuffernd_alpha_month_array.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_alpha_month_array.diminfo[0].strides)) * __pyx_v_beta_i) * __pyx_v_l_sum_avail_i));
/* … */
            if (((__pyx_t_25 &lt; __pyx_t_27) != 0)) {
              __pyx_t_28 = __pyx_t_25;
            } else {
              __pyx_t_28 = __pyx_t_27;
            }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">656</span>:                             <span class="n">alpha_month_array</span><span class="p">[</span><span class="n">m_index</span><span class="p">]</span><span class="o">*</span><span class="n">beta_i</span><span class="o">*</span><span class="n">l_sum_avail_i</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>            __pyx_t_26 = __pyx_v_m_index;
            __pyx_t_19 = -1;
            if (__pyx_t_26 &lt; 0) {
              __pyx_t_26 += __pyx_pybuffernd_alpha_month_array.diminfo[0].shape;
              if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_19 = 0;
            } else if (unlikely(__pyx_t_26 &gt;= __pyx_pybuffernd_alpha_month_array.diminfo[0].shape)) __pyx_t_19 = 0;
            if (unlikely(__pyx_t_19 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
              <span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">657</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:                     <span class="n">target_aet_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">aet_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_aet_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_aet_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">659</span>:                     <span class="n">l_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_i</span> <span class="o">-</span> <span class="n">qf_i</span> <span class="o">-</span> <span class="n">aet_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_l_i = ((__pyx_v_p_i - __pyx_v_qf_i) - __pyx_v_aet_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">661</span>:                     <span class="c"># Equation 8</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">662</span>:                     <span class="n">l_avail_i</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">l_i</span><span class="p">,</span> <span class="n">l_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_27 = __pyx_v_l_i;
          __pyx_t_29 = (__pyx_v_gamma * __pyx_v_l_i);
          if (((__pyx_t_27 &lt; __pyx_t_29) != 0)) {
            __pyx_t_30 = __pyx_t_27;
          } else {
            __pyx_t_30 = __pyx_t_29;
          }
          __pyx_v_l_avail_i = __pyx_t_30;
</pre><pre class="cython line score-0">&#xA0;<span class="">663</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">664</span>:                     <span class="n">target_li_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">l_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_li_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_l_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:                     <span class="n">target_li_avail_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">l_avail_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_li_avail_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_l_avail_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">666</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:                     <span class="n">flow_dir_mfd</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_flow_dir_mfd = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_raster, __pyx_v_xi, __pyx_v_yi));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:                     <span class="k">for</span> <span class="n">i_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_19 = 0; __pyx_t_19 &lt; 8; __pyx_t_19+=1) {
            __pyx_v_i_n = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:                         <span class="k">if</span> <span class="p">((</span><span class="n">flow_dir_mfd</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">i_n</span> <span class="o">*</span> <span class="mf">4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">xF</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = ((((__pyx_v_flow_dir_mfd &gt;&gt; (__pyx_v_i_n * 4)) &amp; 0xF) == 0) != 0);
            if (__pyx_t_20) {
/* … */
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">670</span>:                             <span class="c"># no flow in that direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:                             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L58_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">672</span>:                         <span class="n">xi_n</span> <span class="o">=</span> <span class="n">xi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">i_n</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_xi_n = (__pyx_v_xi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_i_n)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:                         <span class="n">yi_n</span> <span class="o">=</span> <span class="n">yi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">i_n</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_yi_n = (__pyx_v_yi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_i_n) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:                         <span class="k">if</span> <span class="p">(</span><span class="n">xi_n</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xi_n</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = ((__pyx_v_xi_n &lt; 0) != 0);
            if (!__pyx_t_14) {
            } else {
              __pyx_t_20 = __pyx_t_14;
              goto __pyx_L62_bool_binop_done;
            }
            __pyx_t_14 = ((__pyx_v_xi_n &gt;= __pyx_v_raster_x_size) != 0);
            if (!__pyx_t_14) {
            } else {
              __pyx_t_20 = __pyx_t_14;
              goto __pyx_L62_bool_binop_done;
            }
/* … */
            if (__pyx_t_20) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:                                 <span class="n">yi_n</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yi_n</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = ((__pyx_v_yi_n &lt; 0) != 0);
            if (!__pyx_t_14) {
            } else {
              __pyx_t_20 = __pyx_t_14;
              goto __pyx_L62_bool_binop_done;
            }
            __pyx_t_14 = ((__pyx_v_yi_n &gt;= __pyx_v_raster_y_size) != 0);
            __pyx_t_20 = __pyx_t_14;
            __pyx_L62_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">676</span>:                             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L58_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:                         <span class="n">work_queue</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">](</span><span class="n">xi_n</span><span class="p">,</span> <span class="n">yi_n</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>            try {
              __pyx_t_21 = std::pair&lt;int,int&gt; (__pyx_v_xi_n, __pyx_v_yi_n);
            } catch(...) {
              __Pyx_CppExn2PyErr();
              <span class='error_goto'>__PYX_ERR(0, 677, __pyx_L1_error)</span>
            }
            __pyx_v_work_queue.push(__pyx_t_21);
            __pyx_L58_continue:;
          }
          __pyx_L32_continue:;
        }
        __pyx_L20_continue:;
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">678</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">679</span>: </pre>
<pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>: <span class="k">def</span> <span class="nf">route_baseflow_sum</span><span class="p">(</span></pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_3route_baseflow_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_2route_baseflow_sum[] = "Route Baseflow through MFD as described in Equation 11.\n\n    Parameters:\n        flow_dir_mfd_path (string): path to a pygeoprocessing multiple flow\n            direction raster.\n        l_path (string): path to local recharge raster.\n        l_avail_path (string): path to local recharge raster that shows\n            recharge available to the pixel.\n        l_sum_path (string): path to upstream sum of l_path.\n        stream_path (string): path to stream raster, 1 stream, 0 no stream,\n            and nodata.\n        target_b_path (string): path to created raster for per-pixel baseflow.\n        target_b_sum_path (string): path to created raster for per-pixel\n            upstream sum of baseflow.\n\n`    Returns:\n        None.\n\n    ";
static PyMethodDef __pyx_mdef_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_3route_baseflow_sum = {"route_baseflow_sum", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_3route_baseflow_sum, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_2route_baseflow_sum};
static PyObject *__pyx_pw_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_3route_baseflow_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_flow_dir_mfd_path = 0;
  PyObject *__pyx_v_l_path = 0;
  PyObject *__pyx_v_l_avail_path = 0;
  PyObject *__pyx_v_l_sum_path = 0;
  PyObject *__pyx_v_stream_path = 0;
  PyObject *__pyx_v_target_b_path = 0;
  PyObject *__pyx_v_target_b_sum_path = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("route_baseflow_sum (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_flow_dir_mfd_path,&amp;__pyx_n_s_l_path,&amp;__pyx_n_s_l_avail_path,&amp;__pyx_n_s_l_sum_path,&amp;__pyx_n_s_stream_path,&amp;__pyx_n_s_target_b_path,&amp;__pyx_n_s_target_b_sum_path,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_flow_dir_mfd_path)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l_avail_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l_sum_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_stream_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_b_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target_b_sum_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "route_baseflow_sum") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_flow_dir_mfd_path = values[0];
    __pyx_v_l_path = values[1];
    __pyx_v_l_avail_path = values[2];
    __pyx_v_l_sum_path = values[3];
    __pyx_v_stream_path = values[4];
    __pyx_v_target_b_path = values[5];
    __pyx_v_target_b_sum_path = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("route_baseflow_sum", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core.route_baseflow_sum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_2route_baseflow_sum(__pyx_self, __pyx_v_flow_dir_mfd_path, __pyx_v_l_path, __pyx_v_l_avail_path, __pyx_v_l_sum_path, __pyx_v_stream_path, __pyx_v_target_b_path, __pyx_v_target_b_sum_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_2route_baseflow_sum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_flow_dir_mfd_path, PyObject *__pyx_v_l_path, PyObject *__pyx_v_l_avail_path, PyObject *__pyx_v_l_sum_path, PyObject *__pyx_v_stream_path, PyObject *__pyx_v_target_b_path, PyObject *__pyx_v_target_b_sum_path) {
  time_t __pyx_v_last_log_time;
  float __pyx_v_target_nodata;
  int __pyx_v_stream_val;
  int __pyx_v_outlet;
  float __pyx_v_b_i;
  float __pyx_v_b_sum_i;
  float __pyx_v_l_j;
  float __pyx_v_l_avail_j;
  float __pyx_v_l_sum_j;
  int __pyx_v_xi;
  int __pyx_v_yi;
  int __pyx_v_xj;
  int __pyx_v_yj;
  int __pyx_v_flow_dir_i;
  int __pyx_v_p_ij_base;
  int __pyx_v_mfd_dir_sum;
  int __pyx_v_flow_dir_nodata;
  int __pyx_v_raster_x_size;
  int __pyx_v_raster_y_size;
  int __pyx_v_xs_root;
  int __pyx_v_ys_root;
  int __pyx_v_xoff;
  int __pyx_v_yoff;
  int __pyx_v_n_dir;
  int __pyx_v_xs;
  int __pyx_v_ys;
  int __pyx_v_flow_dir_s;
  int __pyx_v_win_xsize;
  int __pyx_v_win_ysize;
  int __pyx_v_stream_nodata;
  std::stack&lt;std::pair&lt;int,int&gt; &gt;  __pyx_v_work_stack;
  PyObject *__pyx_v_flow_dir_raster_info = NULL;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_b_sum_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_target_b_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_l_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_l_avail_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_l_sum_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_flow_dir_mfd_raster = 0;
  struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *__pyx_v_stream_raster = 0;
  PyObject *__pyx_v_current_pixel = NULL;
  PyObject *__pyx_v_offset_dict = NULL;
  long __pyx_v_downstream_defined;
  double __pyx_v_b_sum_j;
  double __pyx_v_l_sum_i;
  double __pyx_v_l_i;
  PyObject *__pyx_v_flow_dir_j = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("route_baseflow_sum", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("natcap.invest.seasonal_water_yield.seasonal_water_yield_core.route_baseflow_sum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flow_dir_raster_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_b_sum_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_target_b_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_l_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_l_avail_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_l_sum_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_flow_dir_mfd_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_stream_raster);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_current_pixel);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_offset_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flow_dir_j);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(53, __pyx_n_s_flow_dir_mfd_path, __pyx_n_s_l_path, __pyx_n_s_l_avail_path, __pyx_n_s_l_sum_path, __pyx_n_s_stream_path, __pyx_n_s_target_b_path, __pyx_n_s_target_b_sum_path, __pyx_n_s_last_log_time, __pyx_n_s_target_nodata, __pyx_n_s_stream_val, __pyx_n_s_outlet, __pyx_n_s_b_i, __pyx_n_s_b_sum_i, __pyx_n_s_l_j, __pyx_n_s_l_avail_j, __pyx_n_s_l_sum_j, __pyx_n_s_xi, __pyx_n_s_yi, __pyx_n_s_xj, __pyx_n_s_yj, __pyx_n_s_flow_dir_i, __pyx_n_s_p_ij_base, __pyx_n_s_mfd_dir_sum, __pyx_n_s_flow_dir_nodata, __pyx_n_s_raster_x_size, __pyx_n_s_raster_y_size, __pyx_n_s_xs_root, __pyx_n_s_ys_root, __pyx_n_s_xoff, __pyx_n_s_yoff, __pyx_n_s_n_dir, __pyx_n_s_xs, __pyx_n_s_ys, __pyx_n_s_flow_dir_s, __pyx_n_s_win_xsize, __pyx_n_s_win_ysize, __pyx_n_s_stream_nodata, __pyx_n_s_work_stack, __pyx_n_s_flow_dir_raster_info, __pyx_n_s_target_b_sum_raster, __pyx_n_s_target_b_raster, __pyx_n_s_l_raster, __pyx_n_s_l_avail_raster, __pyx_n_s_l_sum_raster, __pyx_n_s_flow_dir_mfd_raster, __pyx_n_s_stream_raster, __pyx_n_s_current_pixel, __pyx_n_s_offset_dict, __pyx_n_s_downstream_defined, __pyx_n_s_b_sum_j, __pyx_n_s_l_sum_i, __pyx_n_s_l_i, __pyx_n_s_flow_dir_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_3route_baseflow_sum, NULL, __pyx_n_s_natcap_invest_seasonal_water_yie);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_route_baseflow_sum, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">681</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">l_path</span><span class="p">,</span> <span class="n">l_avail_path</span><span class="p">,</span> <span class="n">l_sum_path</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">682</span>:         <span class="n">stream_path</span><span class="p">,</span> <span class="n">target_b_path</span><span class="p">,</span> <span class="n">target_b_sum_path</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">683</span>:     <span class="sd">&quot;&quot;&quot;Route Baseflow through MFD as described in Equation 11.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">684</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">685</span>: <span class="sd">    Parameters:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">686</span>: <span class="sd">        flow_dir_mfd_path (string): path to a pygeoprocessing multiple flow</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">687</span>: <span class="sd">            direction raster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">688</span>: <span class="sd">        l_path (string): path to local recharge raster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">689</span>: <span class="sd">        l_avail_path (string): path to local recharge raster that shows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">690</span>: <span class="sd">            recharge available to the pixel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">691</span>: <span class="sd">        l_sum_path (string): path to upstream sum of l_path.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">692</span>: <span class="sd">        stream_path (string): path to stream raster, 1 stream, 0 no stream,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">693</span>: <span class="sd">            and nodata.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">694</span>: <span class="sd">        target_b_path (string): path to created raster for per-pixel baseflow.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">695</span>: <span class="sd">        target_b_sum_path (string): path to created raster for per-pixel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">696</span>: <span class="sd">            upstream sum of baseflow.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">697</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">698</span>: <span class="sd">`    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">699</span>: <span class="sd">        None.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">700</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">701</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">702</span>:     <span class="c"># used for time-delayed logging</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">703</span>:     <span class="k">cdef</span> <span class="kt">time_t</span> <span class="nf">last_log_time</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">704</span>:     <span class="n">last_log_time</span> <span class="o">=</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_last_log_time = time(NULL);
</pre><pre class="cython line score-0">&#xA0;<span class="">705</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">target_nodata</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e32</span></pre>
<pre class='cython code score-0 '>  __pyx_v_target_nodata = -1e32;
</pre><pre class="cython line score-0">&#xA0;<span class="">707</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">stream_val</span><span class="p">,</span> <span class="nf">outlet</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">708</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">b_i</span><span class="p">,</span> <span class="nf">b_sum_i</span><span class="p">,</span> <span class="nf">l_j</span><span class="p">,</span> <span class="nf">l_avail_j</span><span class="p">,</span> <span class="nf">l_sum_j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">709</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xi</span><span class="p">,</span> <span class="nf">yi</span><span class="p">,</span> <span class="nf">xj</span><span class="p">,</span> <span class="nf">yj</span><span class="p">,</span> <span class="nf">flow_dir_i</span><span class="p">,</span> <span class="nf">p_ij_base</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">710</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">mfd_dir_sum</span><span class="p">,</span> <span class="nf">flow_dir_nodata</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">711</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">raster_x_size</span><span class="p">,</span> <span class="nf">raster_y_size</span><span class="p">,</span> <span class="nf">xs_root</span><span class="p">,</span> <span class="nf">ys_root</span><span class="p">,</span> <span class="nf">xoff</span><span class="p">,</span> <span class="nf">yoff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">712</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n_dir</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">713</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">xs</span><span class="p">,</span> <span class="nf">ys</span><span class="p">,</span> <span class="nf">flow_dir_s</span><span class="p">,</span> <span class="nf">win_xsize</span><span class="p">,</span> <span class="nf">win_ysize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">714</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">stream_nodata</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">715</span>:     <span class="k">cdef</span> <span class="kt">stack</span>[<span class="kt">pair</span>[<span class="nf">int</span><span class="p">,</span> <span class="kt">int</span>]] <span class="nf">work_stack</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">716</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">717</span>:     <span class="c"># we know the PyGeoprocessing MFD raster flow dir type is a 32 bit int.</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">718</span>:     <span class="n">flow_dir_raster_info</span> <span class="o">=</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">flow_dir_mfd_path</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_flow_dir_mfd_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_flow_dir_raster_info = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">719</span>:     <span class="n">flow_dir_nodata</span> <span class="o">=</span> <span class="n">flow_dir_raster_info</span><span class="p">[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_flow_dir_raster_info, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_flow_dir_nodata = __pyx_t_4;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">720</span>:     <span class="n">raster_x_size</span><span class="p">,</span> <span class="n">raster_y_size</span> <span class="o">=</span> <span class="n">flow_dir_raster_info</span><span class="p">[</span><span class="s">&#39;raster_size&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-62 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_flow_dir_raster_info, __pyx_n_s_raster_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 720, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_1 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_raster_x_size = __pyx_t_4;
  __pyx_v_raster_y_size = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">721</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">722</span>:     <span class="n">stream_nodata</span> <span class="o">=</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">get_raster_info</span><span class="p">(</span><span class="n">stream_path</span><span class="p">)[</span><span class="s">&#39;nodata&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_raster_info);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_stream_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_stream_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_3, __pyx_n_s_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_stream_nodata = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">723</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_b_sum_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_b_sum_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_target_b_sum_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
/* … */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">725</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_b_sum_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:         <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span> <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_fill_value_list, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">727</span>:     <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">new_raster_from_base</span><span class="p">(</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 727, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_new_raster_from_base);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 727, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 727, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_b_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_b_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_target_b_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">728</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="n">target_b_path</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_gdal);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_GDT_Float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">729</span>:         <span class="p">[</span><span class="n">target_nodata</span><span class="p">],</span> <span class="n">fill_value_list</span><span class="o">=</span><span class="p">[</span><span class="n">target_nodata</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
  __pyx_t_8 = 0;
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_target_nodata);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_fill_value_list, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">730</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">731</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_b_sum_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_b_sum_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_b_sum_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_target_b_sum_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_target_b_sum_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">732</span>:         <span class="n">target_b_sum_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">733</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">target_b_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_target_b_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_target_b_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_target_b_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_target_b_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">734</span>:         <span class="n">target_b_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">l_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">l_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_l_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_l_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_l_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_l_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">l_avail_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">l_avail_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_l_avail_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_l_avail_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_l_avail_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_0);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_l_avail_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">737</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">l_sum_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">l_sum_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_l_sum_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_l_sum_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_l_sum_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_l_sum_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">738</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">flow_dir_mfd_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_0);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_flow_dir_mfd_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">739</span>:         <span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">740</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:     <span class="k">cdef</span> <span class="kt">_ManagedRaster</span> <span class="nf">stream_raster</span> <span class="o">=</span> <span class="n">_ManagedRaster</span><span class="p">(</span><span class="n">stream_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_stream_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_stream_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_stream_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_stream_raster = ((struct __pyx_obj_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core__ManagedRaster *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">742</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:     <span class="n">current_pixel</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_current_pixel = __pyx_int_0;
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">744</span>:     <span class="k">for</span> <span class="n">offset_dict</span> <span class="ow">in</span> <span class="n">pygeoprocessing</span><span class="o">.</span><span class="n">iterblocks</span><span class="p">(</span></pre>
<pre class='cython code score-60 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pygeoprocessing);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_iterblocks);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
  __pyx_t_1 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
    __pyx_t_1 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_10(__pyx_t_1);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_offset_dict, __pyx_t_5);
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>:             <span class="p">(</span><span class="n">flow_dir_mfd_path</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="n">offset_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">largest_block</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flow_dir_mfd_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_flow_dir_mfd_path);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_offset_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_largest_block, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">746</span>:         <span class="n">win_xsize</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;win_xsize&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_win_xsize);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 746, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_win_xsize = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">747</span>:         <span class="n">win_ysize</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;win_ysize&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_win_ysize);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_win_ysize = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>:         <span class="n">xoff</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;xoff&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_xoff);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 748, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_xoff = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">749</span>:         <span class="n">yoff</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="s">&#39;yoff&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_offset_dict, __pyx_n_s_yoff);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_yoff = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">750</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">751</span>:         <span class="c"># search block for a peak pixel where no other pixel drains to it.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">752</span>:         <span class="k">for</span> <span class="n">ys</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_ysize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_win_ysize;
    __pyx_t_4 = __pyx_t_7;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_4; __pyx_t_11+=1) {
      __pyx_v_ys = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">753</span>:             <span class="n">ys_root</span> <span class="o">=</span> <span class="n">yoff</span><span class="o">+</span><span class="n">ys</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ys_root = (__pyx_v_yoff + __pyx_v_ys);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">754</span>:             <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">win_xsize</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_win_xsize;
      __pyx_t_13 = __pyx_t_12;
      for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
        __pyx_v_xs = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:                 <span class="n">xs_root</span> <span class="o">=</span> <span class="n">xoff</span><span class="o">+</span><span class="n">xs</span></pre>
<pre class='cython code score-0 '>        __pyx_v_xs_root = (__pyx_v_xoff + __pyx_v_xs);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:                 <span class="n">flow_dir_s</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_dir_mfd_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xs_root</span><span class="p">,</span> <span class="n">ys_root</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_flow_dir_s = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_dir_mfd_raster, __pyx_v_xs_root, __pyx_v_ys_root));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">757</span>:                 <span class="k">if</span> <span class="n">flow_dir_s</span> <span class="o">==</span> <span class="n">flow_dir_nodata</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = ((__pyx_v_flow_dir_s == __pyx_v_flow_dir_nodata) != 0);
        if (__pyx_t_15) {
/* … */
        }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">758</span>:                     <span class="n">current_pixel</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_current_pixel, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 758, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_current_pixel, __pyx_t_5);
          __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L9_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">760</span>:                 <span class="n">outlet</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_outlet = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">761</span>:                 <span class="k">for</span> <span class="n">n_dir</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        for (__pyx_t_16 = 0; __pyx_t_16 &lt; 8; __pyx_t_16+=1) {
          __pyx_v_n_dir = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">762</span>:                     <span class="k">if</span> <span class="p">(</span><span class="n">flow_dir_s</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">n_dir</span> <span class="o">*</span> <span class="mf">4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">xF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = (((__pyx_v_flow_dir_s &gt;&gt; (__pyx_v_n_dir * 4)) &amp; 0xF) != 0);
          if (__pyx_t_15) {
/* … */
          }
          __pyx_L12_continue:;
        }
        __pyx_L13_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">763</span>:                         <span class="c"># flows in this direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">764</span>:                         <span class="n">xj</span> <span class="o">=</span> <span class="n">xs_root</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_xj = (__pyx_v_xs_root + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_n_dir)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">765</span>:                         <span class="n">yj</span> <span class="o">=</span> <span class="n">ys_root</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_yj = (__pyx_v_ys_root + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_n_dir) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">766</span>:                         <span class="k">if</span> <span class="p">(</span><span class="n">xj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xj</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>            __pyx_t_17 = ((__pyx_v_xj &lt; 0) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L16_bool_binop_done;
            }
            __pyx_t_17 = ((__pyx_v_xj &gt;= __pyx_v_raster_x_size) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L16_bool_binop_done;
            }
/* … */
            if (__pyx_t_15) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">767</span>:                                 <span class="n">yj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yj</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>            __pyx_t_17 = ((__pyx_v_yj &lt; 0) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L16_bool_binop_done;
            }
            __pyx_t_17 = ((__pyx_v_yj &gt;= __pyx_v_raster_y_size) != 0);
            __pyx_t_15 = __pyx_t_17;
            __pyx_L16_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">768</span>:                             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L12_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">769</span>:                         <span class="n">stream_val</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">stream_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_stream_val = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_stream_raster, __pyx_v_xj, __pyx_v_yj));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">770</span>:                         <span class="k">if</span> <span class="n">stream_val</span> <span class="o">!=</span> <span class="n">stream_nodata</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_15 = ((__pyx_v_stream_val != __pyx_v_stream_nodata) != 0);
            if (__pyx_t_15) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">771</span>:                             <span class="n">outlet</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>              __pyx_v_outlet = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">772</span>:                             <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L13_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">outlet</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = ((!(__pyx_v_outlet != 0)) != 0);
        if (__pyx_t_15) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">774</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L9_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">775</span>:                 <span class="n">work_stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">](</span><span class="n">xs_root</span><span class="p">,</span> <span class="n">ys_root</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>        try {
          __pyx_t_18 = std::pair&lt;int,int&gt; (__pyx_v_xs_root, __pyx_v_ys_root);
        } catch(...) {
          __Pyx_CppExn2PyErr();
          <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>
        }
        __pyx_v_work_stack.push(__pyx_t_18);
</pre><pre class="cython line score-0">&#xA0;<span class="">776</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">777</span>:                 <span class="k">while</span> <span class="n">work_stack</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_15 = ((__pyx_v_work_stack.size() &gt; 0) != 0);
          if (!__pyx_t_15) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">778</span>:                     <span class="n">xi</span> <span class="o">=</span> <span class="n">work_stack</span><span class="o">.</span><span class="n">top</span><span class="p">()</span><span class="o">.</span><span class="n">first</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = __pyx_v_work_stack.top().first;
          __pyx_v_xi = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">779</span>:                     <span class="n">yi</span> <span class="o">=</span> <span class="n">work_stack</span><span class="o">.</span><span class="n">top</span><span class="p">()</span><span class="o">.</span><span class="n">second</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = __pyx_v_work_stack.top().second;
          __pyx_v_yi = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">780</span>:                     <span class="n">work_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>          __pyx_v_work_stack.pop();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">781</span>:                     <span class="n">b_sum_i</span> <span class="o">=</span> <span class="n">target_b_sum_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_b_sum_i = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_target_b_sum_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">782</span>:                     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_close</span><span class="p">(</span><span class="n">b_sum_i</span><span class="p">,</span> <span class="n">target_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((!(__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_b_sum_i, __pyx_v_target_nodata) != 0)) != 0);
          if (__pyx_t_15) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">783</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L22_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">784</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">785</span>:                     <span class="k">if</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span> <span class="o">-</span> <span class="n">last_log_time</span> <span class="o">&gt;</span> <span class="mf">5.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = (((time(NULL) - __pyx_v_last_log_time) &gt; 5.0) != 0);
          if (__pyx_t_15) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">786</span>:                         <span class="n">last_log_time</span> <span class="o">=</span> <span class="n">ctime</span><span class="p">(</span><span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_last_log_time = time(NULL);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">787</span>:                         <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_LOGGER);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_info);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">788</span>:                             <span class="s">&#39;route base flow </span><span class="si">%.2f%%</span><span class="s"> complete&#39;</span><span class="p">,</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">789</span>:                             <span class="mf">100.0</span> <span class="o">*</span> <span class="n">current_pixel</span> <span class="o">/</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;(</span></pre>
<pre class='cython code score-53 '>            __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_100_0, __pyx_v_current_pixel);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
/* … */
            __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)(__pyx_v_raster_x_size * __pyx_v_raster_y_size)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = NULL;
            __pyx_t_16 = 0;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
              __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
              if (likely(__pyx_t_3)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
                __pyx_t_16 = 1;
              }
            }
            #if CYTHON_FAST_PYCALL
            if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
              PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_kp_s_route_base_flow_2f_complete, __pyx_t_19};
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            } else
            #endif
            #if CYTHON_FAST_PYCCALL
            if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
              PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_kp_s_route_base_flow_2f_complete, __pyx_t_19};
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            } else
            #endif
            {
              __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              if (__pyx_t_3) {
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
              }
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_route_base_flow_2f_complete);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_route_base_flow_2f_complete);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_16, __pyx_kp_s_route_base_flow_2f_complete);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_16, __pyx_t_19);
              __pyx_t_19 = 0;
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">790</span>:                                 <span class="n">raster_x_size</span> <span class="o">*</span> <span class="n">raster_y_size</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">791</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">792</span>:                     <span class="n">b_sum_i</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_b_sum_i = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">793</span>:                     <span class="n">mfd_dir_sum</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_mfd_dir_sum = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">794</span>:                     <span class="n">downstream_defined</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_downstream_defined = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">795</span>:                     <span class="n">flow_dir_i</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_dir_mfd_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_flow_dir_i = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_dir_mfd_raster, __pyx_v_xi, __pyx_v_yi));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">796</span>:                     <span class="k">if</span> <span class="n">flow_dir_i</span> <span class="o">==</span> <span class="n">flow_dir_nodata</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((__pyx_v_flow_dir_i == __pyx_v_flow_dir_nodata) != 0);
          if (__pyx_t_15) {
/* … */
          }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">797</span>:                         <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;flow dir nodata? this makes no sense&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_LOGGER);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_error);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = NULL;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
              __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
              if (likely(__pyx_t_2)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
              }
            }
            __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_2, __pyx_kp_s_flow_dir_nodata_this_makes_no_se) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_kp_s_flow_dir_nodata_this_makes_no_se);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">798</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L22_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:                     <span class="k">for</span> <span class="n">n_dir</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_16 = 0; __pyx_t_16 &lt; 8; __pyx_t_16+=1) {
            __pyx_v_n_dir = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">800</span>:                         <span class="k">if</span> <span class="ow">not</span> <span class="n">downstream_defined</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_15 = ((!(__pyx_v_downstream_defined != 0)) != 0);
            if (__pyx_t_15) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">801</span>:                             <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L28_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">802</span>:                         <span class="c"># searching around the pattern:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">803</span>:                         <span class="c"># 321</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">804</span>:                         <span class="c"># 4x0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">805</span>:                         <span class="c"># 567</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">806</span>:                         <span class="n">p_ij_base</span> <span class="o">=</span> <span class="p">(</span><span class="n">flow_dir_i</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mf">4</span><span class="o">*</span><span class="n">n_dir</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">xF</span></pre>
<pre class='cython code score-0 '>            __pyx_v_p_ij_base = ((__pyx_v_flow_dir_i &gt;&gt; (4 * __pyx_v_n_dir)) &amp; 0xF);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">807</span>:                         <span class="k">if</span> <span class="n">p_ij_base</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_15 = (__pyx_v_p_ij_base != 0);
            if (__pyx_t_15) {
/* … */
            }
            __pyx_L27_continue:;
          }
          __pyx_L28_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">808</span>:                             <span class="n">mfd_dir_sum</span> <span class="o">+=</span> <span class="n">p_ij_base</span></pre>
<pre class='cython code score-0 '>              __pyx_v_mfd_dir_sum = (__pyx_v_mfd_dir_sum + __pyx_v_p_ij_base);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">809</span>:                             <span class="n">xj</span> <span class="o">=</span> <span class="n">xi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_xj = (__pyx_v_xi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_n_dir)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">810</span>:                             <span class="n">yj</span> <span class="o">=</span> <span class="n">yi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_yj = (__pyx_v_yi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_n_dir) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">811</span>:                             <span class="k">if</span> <span class="p">(</span><span class="n">xj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xj</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>              __pyx_t_17 = ((__pyx_v_xj &lt; 0) != 0);
              if (!__pyx_t_17) {
              } else {
                __pyx_t_15 = __pyx_t_17;
                goto __pyx_L32_bool_binop_done;
              }
              __pyx_t_17 = ((__pyx_v_xj &gt;= __pyx_v_raster_x_size) != 0);
              if (!__pyx_t_17) {
              } else {
                __pyx_t_15 = __pyx_t_17;
                goto __pyx_L32_bool_binop_done;
              }
/* … */
              if (__pyx_t_15) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:                                     <span class="n">yj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yj</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>              __pyx_t_17 = ((__pyx_v_yj &lt; 0) != 0);
              if (!__pyx_t_17) {
              } else {
                __pyx_t_15 = __pyx_t_17;
                goto __pyx_L32_bool_binop_done;
              }
              __pyx_t_17 = ((__pyx_v_yj &gt;= __pyx_v_raster_y_size) != 0);
              __pyx_t_15 = __pyx_t_17;
              __pyx_L32_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">813</span>:                                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>                goto __pyx_L27_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:                             <span class="n">stream_val</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">stream_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_v_stream_val = ((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_stream_raster, __pyx_v_xj, __pyx_v_yj));
</pre><pre class="cython line score-0">&#xA0;<span class="">815</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">816</span>:                             <span class="k">if</span> <span class="n">stream_val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_15 = (__pyx_v_stream_val != 0);
              if (__pyx_t_15) {
/* … */
                goto __pyx_L36;
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">817</span>:                                 <span class="n">b_sum_i</span> <span class="o">+=</span> <span class="n">p_ij_base</span></pre>
<pre class='cython code score-0 '>                __pyx_v_b_sum_i = (__pyx_v_b_sum_i + __pyx_v_p_ij_base);
</pre><pre class="cython line score-0">&#xA0;<span class="">818</span>:                             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">819</span>:                                 <span class="n">b_sum_j</span> <span class="o">=</span> <span class="n">target_b_sum_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              /*else*/ {
                __pyx_v_b_sum_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_target_b_sum_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">820</span>:                                 <span class="k">if</span> <span class="n">is_close</span><span class="p">(</span><span class="n">b_sum_j</span><span class="p">,</span> <span class="n">target_nodata</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                __pyx_t_15 = (__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_is_close(__pyx_v_b_sum_j, __pyx_v_target_nodata) != 0);
                if (__pyx_t_15) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">821</span>:                                     <span class="n">downstream_defined</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>                  __pyx_v_downstream_defined = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">822</span>:                                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>                  goto __pyx_L28_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>:                                 <span class="n">l_j</span> <span class="o">=</span> <span class="n">l_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                __pyx_v_l_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_l_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">824</span>:                                 <span class="n">l_avail_j</span> <span class="o">=</span> <span class="n">l_avail_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                __pyx_v_l_avail_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_l_avail_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">825</span>:                                 <span class="n">l_sum_j</span> <span class="o">=</span> <span class="n">l_sum_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                __pyx_v_l_sum_j = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_l_sum_raster, __pyx_v_xj, __pyx_v_yj);
</pre><pre class="cython line score-0">&#xA0;<span class="">826</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">827</span>:                                 <span class="k">if</span> <span class="n">l_sum_j</span> <span class="o">!=</span> <span class="mf">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">l_sum_j</span> <span class="o">-</span> <span class="n">l_j</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                __pyx_t_17 = ((__pyx_v_l_sum_j != 0.0) != 0);
                if (__pyx_t_17) {
                } else {
                  __pyx_t_15 = __pyx_t_17;
                  goto __pyx_L39_bool_binop_done;
                }
                __pyx_t_17 = (((__pyx_v_l_sum_j - __pyx_v_l_j) != 0.0) != 0);
                __pyx_t_15 = __pyx_t_17;
                __pyx_L39_bool_binop_done:;
                if (__pyx_t_15) {
/* … */
                  goto __pyx_L38;
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">828</span>:                                     <span class="n">b_sum_i</span> <span class="o">+=</span> <span class="n">p_ij_base</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>                  __pyx_v_b_sum_i = (__pyx_v_b_sum_i + (__pyx_v_p_ij_base * ((1.0 - (__pyx_v_l_avail_j / __pyx_v_l_sum_j)) * (__pyx_v_b_sum_j / __pyx_t_20))));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">829</span>:                                         <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="n">l_avail_j</span> <span class="o">/</span> <span class="n">l_sum_j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>                  if (unlikely(__pyx_v_l_sum_j == 0)) {
                    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
                    <span class='error_goto'>__PYX_ERR(0, 829, __pyx_L1_error)</span>
                  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">830</span>:                                             <span class="n">b_sum_j</span> <span class="o">/</span> <span class="p">(</span><span class="n">l_sum_j</span> <span class="o">-</span> <span class="n">l_j</span><span class="p">)))</span></pre>
<pre class='cython code score-5 '>                  __pyx_t_20 = (__pyx_v_l_sum_j - __pyx_v_l_j);
                  if (unlikely(__pyx_t_20 == 0)) {
                    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
                    <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
                  }
</pre><pre class="cython line score-0">&#xA0;<span class="">831</span>:                                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">832</span>:                                     <span class="n">b_sum_i</span> <span class="o">+=</span> <span class="n">p_ij_base</span></pre>
<pre class='cython code score-0 '>                /*else*/ {
                  __pyx_v_b_sum_i = (__pyx_v_b_sum_i + __pyx_v_p_ij_base);
                }
                __pyx_L38:;
              }
              __pyx_L36:;
</pre><pre class="cython line score-0">&#xA0;<span class="">833</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:                     <span class="k">if</span> <span class="ow">not</span> <span class="n">downstream_defined</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((!(__pyx_v_downstream_defined != 0)) != 0);
          if (__pyx_t_15) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">835</span>:                         <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L22_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">836</span>:                     <span class="n">l_sum_i</span> <span class="o">=</span> <span class="n">l_sum_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_l_sum_i = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_l_sum_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">837</span>:                     <span class="k">if</span> <span class="n">mfd_dir_sum</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((__pyx_v_mfd_dir_sum &gt; 0) != 0);
          if (__pyx_t_15) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">838</span>:                         <span class="c"># normalize by mfd weight</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">839</span>:                         <span class="n">b_sum_i</span> <span class="o">=</span> <span class="n">l_sum_i</span> <span class="o">*</span> <span class="n">b_sum_i</span> <span class="o">/</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span><span class="n">mfd_dir_sum</span></pre>
<pre class='cython code score-5 '>            __pyx_t_21 = (__pyx_v_l_sum_i * __pyx_v_b_sum_i);
            if (unlikely(((float)__pyx_v_mfd_dir_sum) == 0)) {
              <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
              <span class='error_goto'>__PYX_ERR(0, 839, __pyx_L1_error)</span>
            }
            __pyx_v_b_sum_i = (__pyx_t_21 / ((float)__pyx_v_mfd_dir_sum));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">840</span>:                     <span class="n">target_b_sum_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">b_sum_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_b_sum_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_b_sum_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">841</span>:                     <span class="n">l_i</span> <span class="o">=</span> <span class="n">l_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_l_i = __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_l_raster, __pyx_v_xi, __pyx_v_yi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">842</span>:                     <span class="k">if</span> <span class="n">l_sum_i</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((__pyx_v_l_sum_i != 0.0) != 0);
          if (__pyx_t_15) {
/* … */
            goto __pyx_L43;
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">843</span>:                         <span class="n">b_i</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">b_sum_i</span> <span class="o">*</span> <span class="n">l_i</span> <span class="o">/</span> <span class="n">l_sum_i</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>            __pyx_t_21 = 0.0;
            __pyx_t_22 = (__pyx_v_b_sum_i * __pyx_v_l_i);
            if (unlikely(__pyx_v_l_sum_i == 0)) {
              <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
              <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
            }
            __pyx_t_23 = (__pyx_t_22 / __pyx_v_l_sum_i);
            if (((__pyx_t_21 &gt; __pyx_t_23) != 0)) {
              __pyx_t_22 = __pyx_t_21;
            } else {
              __pyx_t_22 = __pyx_t_23;
            }
            __pyx_v_b_i = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">844</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">845</span>:                         <span class="n">b_i</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_v_b_i = 0.0;
          }
          __pyx_L43:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">846</span>:                     <span class="n">target_b_raster</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">b_i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_set(__pyx_v_target_b_raster, __pyx_v_xi, __pyx_v_yi, __pyx_v_b_i);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">847</span>:                     <span class="n">current_pixel</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_current_pixel, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 847, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_current_pixel, __pyx_t_5);
          __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">848</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">849</span>:                     <span class="k">for</span> <span class="n">n_dir</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_16 = 0; __pyx_t_16 &lt; 8; __pyx_t_16+=1) {
            __pyx_v_n_dir = __pyx_t_16;
</pre><pre class="cython line score-0">&#xA0;<span class="">850</span>:                         <span class="c"># searching upstream for pixels that flow in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">851</span>:                         <span class="c"># 321</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">852</span>:                         <span class="c"># 4x0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">853</span>:                         <span class="c"># 567</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">854</span>:                         <span class="n">xj</span> <span class="o">=</span> <span class="n">xi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_xj = (__pyx_v_xi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[(2 * __pyx_v_n_dir)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:                         <span class="n">yj</span> <span class="o">=</span> <span class="n">yi</span><span class="o">+</span><span class="n">NEIGHBOR_OFFSET_ARRAY</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="n">n_dir</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_yj = (__pyx_v_yi + (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_NEIGHBOR_OFFSET_ARRAY[((2 * __pyx_v_n_dir) + 1)]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">856</span>:                         <span class="k">if</span> <span class="p">(</span><span class="n">xj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">xj</span> <span class="o">&gt;=</span> <span class="n">raster_x_size</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>            __pyx_t_17 = ((__pyx_v_xj &lt; 0) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L47_bool_binop_done;
            }
            __pyx_t_17 = ((__pyx_v_xj &gt;= __pyx_v_raster_x_size) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L47_bool_binop_done;
            }
/* … */
            if (__pyx_t_15) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">857</span>:                                 <span class="n">yj</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">yj</span> <span class="o">&gt;=</span> <span class="n">raster_y_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>            __pyx_t_17 = ((__pyx_v_yj &lt; 0) != 0);
            if (!__pyx_t_17) {
            } else {
              __pyx_t_15 = __pyx_t_17;
              goto __pyx_L47_bool_binop_done;
            }
            __pyx_t_17 = ((__pyx_v_yj &gt;= __pyx_v_raster_y_size) != 0);
            __pyx_t_15 = __pyx_t_17;
            __pyx_L47_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">858</span>:                             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L44_continue;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">859</span>:                         <span class="n">flow_dir_j</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">flow_dir_mfd_raster</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)__pyx_f_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_14_ManagedRaster_get(__pyx_v_flow_dir_mfd_raster, __pyx_v_xj, __pyx_v_yj)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_flow_dir_j, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">860</span>:                         <span class="k">if</span> <span class="p">(</span><span class="mf">0</span><span class="n">xF</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flow_dir_j</span> <span class="o">&gt;&gt;</span> <span class="p">(</span></pre>
<pre class='cython code score-12 '>            __pyx_t_8 = <span class='py_c_api'>PyNumber_Rshift</span>(__pyx_v_flow_dir_j, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 860, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AndCObj</span>(__pyx_int_15, __pyx_t_8, 0xF, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 860, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_15 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 860, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            if (__pyx_t_15) {
/* … */
            }
            __pyx_L44_continue:;
          }
          __pyx_L22_continue:;
        }
        __pyx_L9_continue:;
      }
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">861</span>:                                 <span class="mf">4</span> <span class="o">*</span> <span class="n">FLOW_DIR_REVERSE_DIRECTION</span><span class="p">[</span><span class="n">n_dir</span><span class="p">]))):</span></pre>
<pre class='cython code score-2 '>            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((4 * (__pyx_v_6natcap_6invest_20seasonal_water_yield_25seasonal_water_yield_core_FLOW_DIR_REVERSE_DIRECTION[__pyx_v_n_dir])));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">862</span>:                             <span class="c"># pixel flows here, push on queue</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">863</span>:                             <span class="n">work_stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">](</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>              try {
                __pyx_t_18 = std::pair&lt;int,int&gt; (__pyx_v_xj, __pyx_v_yj);
              } catch(...) {
                __Pyx_CppExn2PyErr();
                <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
              }
              __pyx_v_work_stack.push(__pyx_t_18);
</pre></div></body></html>
